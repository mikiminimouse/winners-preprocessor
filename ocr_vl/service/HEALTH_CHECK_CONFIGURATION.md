# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Health Check –¥–ª—è Cloud.ru ML Inference

**–î–∞—Ç–∞:** 05.12.2025

## üî¥ –ü—Ä–æ–±–ª–µ–º–∞

Health check —É–±–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞, –Ω–µ –¥–∞–≤–∞—è –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é.

## üìã –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Startup Probe (–ö–†–ò–¢–ò–ß–ù–û!)

```yaml
startupProbe:
  httpGet:
    path: /health
    port: 8081
    scheme: HTTP
  initialDelaySeconds: 10        # –î–∞—Ç—å –≤—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
  periodSeconds: 10              # –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
  timeoutSeconds: 5              # –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ 5 —Å–µ–∫—É–Ω–¥
  failureThreshold: 50           # –î–æ 500 —Å–µ–∫—É–Ω–¥ (8+ –º–∏–Ω—É—Ç) –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
  successThreshold: 1            # 1 —É—Å–ø–µ—à–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ = –≥–æ—Ç–æ–≤
```

**–í–∞–∂–Ω–æ:** Startup probe –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å—Ç–∞—Ç—É—Å "starting" –∫–∞–∫ –≤–∞–ª–∏–¥–Ω—ã–π –æ—Ç–≤–µ—Ç (HTTP 200 OK).

### Liveness Probe

```yaml
livenessProbe:
  httpGet:
    path: /health
    port: 8081
    scheme: HTTP
  initialDelaySeconds: 300       # 5 –º–∏–Ω—É—Ç - –¥–∞—Ç—å –≤—Ä–µ–º—è –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
  periodSeconds: 30              # –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
  timeoutSeconds: 10             # –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ 10 —Å–µ–∫—É–Ω–¥
  failureThreshold: 3            # 3 –Ω–µ—É–¥–∞—á–∏ = –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
  successThreshold: 1
```

### Readiness Probe

```yaml
readinessProbe:
  httpGet:
    path: /health
    port: 8081
    scheme: HTTP
  initialDelaySeconds: 180       # 3 –º–∏–Ω—É—Ç—ã - –¥–∞—Ç—å –≤—Ä–µ–º—è –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
  periodSeconds: 15              # –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
  timeoutSeconds: 5              # –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ 5 —Å–µ–∫—É–Ω–¥
  failureThreshold: 3            # 3 –Ω–µ—É–¥–∞—á–∏ = —É–±—Ä–∞—Ç—å –∏–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞
  successThreshold: 1
```

## üéØ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –°—Ç–∞—Ç—É—Å—ã Health Check:

1. **"starting"** - –≤–æ –≤—Ä–µ–º—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:
   - HTTP 200 OK
   - `{"status": "starting", "paddleocr": "initializing"}`
   - Startup probe –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å —ç—Ç–æ—Ç —Å—Ç–∞—Ç—É—Å

2. **"healthy"** - –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:
   - HTTP 200 OK
   - `{"status": "healthy", "paddleocr": "ready"}`
   - –í—Å–µ probe –ø—Ä–∏–Ω–∏–º–∞—é—Ç —ç—Ç–æ—Ç —Å—Ç–∞—Ç—É—Å

### –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞:

```
0-10 —Å–µ–∫:   –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
10-100 —Å–µ–∫: –ò–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (status: "starting")
100+ —Å–µ–∫:   –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ (status: "healthy")
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **Startup probe –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω:**
   - –ë–µ–∑ startup probe –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è liveness probe
   - Liveness probe —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–µ–Ω –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

2. **–í—Å–µ probe –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–Ω–∏–º–∞—Ç—å HTTP 200:**
   - –î–∞–∂–µ —Å—Ç–∞—Ç—É—Å "starting" –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200 OK
   - –≠—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞, –∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞

3. **–¢–∞–π–º–∞—É—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º–∏:**
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç 80-90 —Å–µ–∫—É–Ω–¥
   - –ü–ª—é—Å –≤—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
   - –ò—Ç–æ–≥–æ: –º–∏–Ω–∏–º—É–º 2-3 –º–∏–Ω—É—Ç—ã

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Cloud.ru

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

1. **–ï—Å—Ç—å –ª–∏ Startup Probe?**
   - –ï—Å–ª–∏ –Ω–µ—Ç - –¥–æ–±–∞–≤–∏—Ç—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –≤—ã—à–µ

2. **–ö–∞–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã?**
   - –î–æ–ª–∂–Ω—ã –±—ã—Ç—å >= –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã—à–µ

3. **–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç /health endpoint?**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "starting"

## üìù –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```yaml
containers:
- name: paddleocr-vl-service
  image: docling-granite-258m.cr.cloud.ru/paddleocr-vl-service:1.3.6
  ports:
  - containerPort: 8081
    protocol: TCP
  startupProbe:
    httpGet:
      path: /health
      port: 8081
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 50
    successThreshold: 1
  livenessProbe:
    httpGet:
      path: /health
      port: 8081
    initialDelaySeconds: 300
    periodSeconds: 30
    timeoutSeconds: 10
    failureThreshold: 3
  readinessProbe:
    httpGet:
      path: /health
      port: 8081
    initialDelaySeconds: 180
    periodSeconds: 15
    timeoutSeconds: 5
    failureThreshold: 3
```

---

**–ö–†–ò–¢–ò–ß–ù–û:** –ë–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ health check –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—É–¥–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è!


