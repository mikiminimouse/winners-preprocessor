# –û—Ç—á–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è PaddleOCR-VL ML Inference

**–î–∞—Ç–∞:** 05.12.2025  
**ML Inference URL:** `https://c5b0e67c-1426-48e5-b2cd-c86c0acdb5c3.modelrun.inference.cloud.ru`  
**–°—Ç–∞—Ç—É—Å:** –ó–∞–ø—É—â–µ–Ω ‚úÖ

## üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. Health Check: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢

```json
{
  "status": "healthy",
  "paddleocr": "not_initialized",
  "s3_storage": "configured",
  "output_dir": "/app/output",
  "temp_dir": "/app/temp"
}
```

**–í—ã–≤–æ–¥:**
- ‚úÖ –°–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
- ‚ö†Ô∏è PaddleOCR –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ)
- ‚úÖ S3 –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 2. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PDF –≤ MD: ‚ùå –û–®–ò–ë–ö–ê

**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã:**
1. `–ü—Ä–æ—Ç–æ–∫–æ–ª_–ø–æ–¥–≤–µ–¥–µ–Ω–∏—è_–∏—Ç–æ–≥–æ–≤ ‚Ññ 2323-2503691630.pdf` (1.2MB, 2 —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
2. `–ø—Ä–æ—Ç–æ–∫–æ–ª.pdf` (309KB, 2 —Å—Ç—Ä–∞–Ω–∏—Ü—ã)

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
Permission denied: '/app/temp/tmp*.jpg'
```

**–°—Ç–∞—Ç—É—Å:** 
- ‚ùå –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å—Ç—Ä–∞–Ω–∏—Ü: 0/4
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PDF ‚Üí –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ùå –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ OCR: –æ—à–∏–±–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ `/app/temp`

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: `[Errno 13] Permission denied`
- PaddleOCR –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ü—Ä–∏—á–∏–Ω–∞:**
- –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/app/temp` —Å–æ–∑–¥–∞–µ—Ç—Å—è –±–µ–∑ –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–¥ –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –í–æ–∑–º–æ–∂–Ω–æ, –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–µ root)

**–†–µ—à–µ–Ω–∏–µ:**
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –æ–±—Ä–∞–∑–µ:
- –î–æ–±–∞–≤–ª–µ–Ω `chmod -R 777 /app/output /app/temp` –≤ Dockerfile
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –≤ `server.py` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `mode='wb'` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

**–¢—Ä–µ–±—É–µ—Ç—Å—è:**
- ‚ö†Ô∏è –û–±–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–∑ –Ω–∞ Cloud.ru ML Inference
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å —Å –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π –æ–±—Ä–∞–∑–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 2: PaddleOCR –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

**–°–∏–º–ø—Ç–æ–º—ã:**
- Health check –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `"paddleocr": "not_initialized"`
- –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏)

**–ü—Ä–∏—á–∏–Ω–∞:**
- –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ) –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

**–†–µ—à–µ–Ω–∏–µ:**
‚úÖ –≠—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤:
- Health check: ~0.1-0.2s ‚úÖ
- OCR –∑–∞–ø—Ä–æ—Å: –æ—à–∏–±–∫–∞ –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è OCR ‚ùå

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF:
- –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: 2
- –í—Å–µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü: 4
- –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 0
- –û—à–∏–±–æ–∫: 4
- –í—Ä–µ–º—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ PDF ‚Üí –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ~0.5s –Ω–∞ —Ñ–∞–π–ª ‚úÖ

## üîß –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. Dockerfile
```dockerfile
# –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
RUN mkdir -p /app/output /app/temp && \
    chmod -R 777 /app/output /app/temp
```

### 2. server.py - –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

**–í —Ñ—É–Ω–∫—Ü–∏—è—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤:**
```python
# –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞
TEMP_DIR.mkdir(parents=True, exist_ok=True)
os.chmod(TEMP_DIR, 0o777)

# –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞
os.chmod(temp_file.name, 0o666)
```

### 3. –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PaddleOCR

**–°—Ç–∞—Ä—Ç –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**
- PaddleOCR –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ
- Health check –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "not_initialized" –¥–æ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

### 4. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–í `process_with_paddleocr`:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ PaddleOCR
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å-–∫–æ–¥—ã (503 –¥–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞)

## üì¶ –û–±—Ä–∞–∑—ã

### –¢–µ–∫—É—â–∏–π –æ–±—Ä–∞–∑ –Ω–∞ Cloud.ru:
```
docling-granite-258m.cr.cloud.ru/paddleocr-vl-service@sha256:e7afa04004434b4f973441a3d7d609317ca31ed99a28f1c9230e9449cddb71ce
```

### –ù–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏:
```
docling-granite-258m.cr.cloud.ru/paddleocr-vl-service:latest
Digest: sha256:e8458f09db793f76449416868e41dd3ffd52a9c8e753ee0e924dbcff9c4851e0
```

**–í–µ—Ä—Å–∏—è:** 1.0.2

## ‚úÖ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –û–±–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–∑ –Ω–∞ Cloud.ru

–í Cloud.ru ML Inference:
1. –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞ `paddleocr-contaner-custom`
2. –û–±–Ω–æ–≤–∏—Ç—å URI –æ–±—Ä–∞–∑–∞ –Ω–∞: `docling-granite-258m.cr.cloud.ru/paddleocr-vl-service:latest`
3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å digest: `docling-granite-258m.cr.cloud.ru/paddleocr-vl-service@sha256:e8458f09db793f76449416868e41dd3ffd52a9c8e753ee0e924dbcff9c4851e0`
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å

### 2. –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–∑–∞:

```bash
export ML_INFERENCE_URL="https://c5b0e67c-1426-48e5-b2cd-c86c0acdb5c3.modelrun.inference.cloud.ru"
export ML_INFERENCE_API_KEY="ZDRhOWQ3OTAtZjU4MC00MzA2LThhNTgtMDU1NGFlMjE4OWRl.85a830f9340966e0ad1fd1642884c7c8"

cd /root/winners_preprocessor/paddle_docker_servise
python3 test_pdf_conversion.py
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PaddleOCR –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
- –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `/app/output` –∏ `/app/temp`

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è production:

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—Ä–µ–º—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ PaddleOCR
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –≤ `/app/temp`

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫—É –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ `/app/temp`
   - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ in-memory –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –º–∞–ª—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
   - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏—Ö –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (775 –≤–º–µ—Å—Ç–æ 777)
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üéØ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|--------|-------------|
| Health Check | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| API –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | ‚úÖ | Bearer token —Ä–∞–±–æ—Ç–∞–µ—Ç |
| PDF ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | ‚úÖ | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç |
| –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ | ‚ö†Ô∏è | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –æ–±—Ä–∞–∑–µ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |
| PaddleOCR –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è | ‚ö†Ô∏è | –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ |
| S3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | ‚úÖ | –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |

**–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

