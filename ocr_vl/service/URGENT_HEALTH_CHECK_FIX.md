# ‚ö†Ô∏è –°–†–û–ß–ù–û: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Health Check –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è SIGTERM

**–î–∞—Ç–∞:** 05.12.2025  
**–°—Ç–∞—Ç—É—Å:** –ö–†–ò–¢–ò–ß–ù–û  
**–í–µ—Ä—Å–∏—è –æ–±—Ä–∞–∑–∞:** 1.3.6

## üî¥ –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç SIGTERM –∫–∞–∂–¥—ã–µ 37-39 —Å–µ–∫—É–Ω–¥ –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞.

**–õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:**
- 13:10:39 - SIGTERM
- 13:11:19 - SIGTERM (—á–µ—Ä–µ–∑ 39 —Å–µ–∫)
- 13:11:59 - SIGTERM (—á–µ—Ä–µ–∑ 39 —Å–µ–∫)
- 13:12:39 - SIGTERM (—á–µ—Ä–µ–∑ 39 —Å–µ–∫)
- ... (–±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª)

## ‚è±Ô∏è –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

### –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é:
- –ó–∞–ø—É—Å–∫ FastAPI: ~1-2 —Å–µ–∫
- –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫: ~2-3 —Å–µ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π PaddleOCR-VL: **~80-90 —Å–µ–∫—É–Ω–¥**
- **–ò–¢–û–ì–û: ~90-95 —Å–µ–∫—É–Ω–¥ –º–∏–Ω–∏–º—É–º**

### –ß—Ç–æ –¥–∞–µ—Ç —Ç–µ–∫—É—â–∏–π Health Check:
- **~37-39 —Å–µ–∫—É–Ω–¥** –¥–æ SIGTERM
- –≠—Ç–æ **–º–µ–Ω–µ–µ –ø–æ–ª–æ–≤–∏–Ω—ã** –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏!

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Health Check –Ω–∞ Cloud.ru:

#### 1. Startup Probe (–ö–†–ò–¢–ò–ß–ù–û!):

```
failureThreshold: 50
initialDelaySeconds: 10
periodSeconds: 10
timeoutSeconds: 5
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 10 + (50 * 10) = **510 —Å–µ–∫—É–Ω–¥ (8.5 –º–∏–Ω—É—Ç)** –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é

#### 2. Liveness Probe:

```
initialDelaySeconds: 300    # 5 –º–∏–Ω—É—Ç
periodSeconds: 30
timeoutSeconds: 5
failureThreshold: 3
```

#### 3. Readiness Probe:

```
initialDelaySeconds: 180    # 3 –º–∏–Ω—É—Ç—ã
periodSeconds: 15
timeoutSeconds: 5
failureThreshold: 3
```

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Container App –Ω–∞ Cloud.ru

1. –í–æ–π–¥–∏—Ç–µ –≤ Cloud.ru
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ ML Inference
3. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à Container App
4. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Health Check

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Startup Probe

**–≠—Ç–æ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä!**

- **Failure Threshold:** `50` (–º–∏–Ω–∏–º—É–º!)
- **Initial Delay:** `10` —Å–µ–∫—É–Ω–¥
- **Period:** `10` —Å–µ–∫—É–Ω–¥
- **Timeout:** `5` —Å–µ–∫—É–Ω–¥

**Endpoint:** `/health`
**Expected Status:** `200` –∏–ª–∏ `503` (starting)

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Liveness Probe

- **Initial Delay:** `300` —Å–µ–∫—É–Ω–¥ (5 –º–∏–Ω—É—Ç)
- **Period:** `30` —Å–µ–∫—É–Ω–¥
- **Timeout:** `5` —Å–µ–∫—É–Ω–¥
- **Failure Threshold:** `3`

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Readiness Probe

- **Initial Delay:** `180` —Å–µ–∫—É–Ω–¥ (3 –º–∏–Ω—É—Ç—ã)
- **Period:** `15` —Å–µ–∫—É–Ω–¥
- **Timeout:** `5` —Å–µ–∫—É–Ω–¥
- **Failure Threshold:** `3`

### –®–∞–≥ 5: –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–æ–ª–∂–µ–Ω:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å—Å—è
2. –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
3. –£—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è
4. –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ

## üéØ –í–∞–∂–Ω–æ

### Health Check –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å—Ç–∞—Ç—É—Å "starting":

–í–µ—Ä—Å–∏—è 1.3.6 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- `{"status": "starting", "paddleocr": "initializing"}` - –≤–æ –≤—Ä–µ–º—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- `{"status": "healthy", "paddleocr": "ready"}` - –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

**Startup Probe –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å –û–ë–ê —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–∫ –≤–∞–ª–∏–¥–Ω—ã–µ!**

## ‚ö†Ô∏è –ë–µ–∑ —ç—Ç–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:

- ‚ùå –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
- ‚ùå –°–µ—Ä–≤–∏—Å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

## ‚úÖ –° –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

- ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —É—Å–ø–µ–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è
- ‚úÖ –°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã

## üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `CLOUDRU_HEALTH_CHECK_SETUP.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- `HEALTH_CHECK_CONFIGURATION.md` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
- `SIGTERM_LOOP_ANALYSIS.md` - –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

---

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û:** –ë–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Health Check —Å–µ—Ä–≤–∏—Å –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!


