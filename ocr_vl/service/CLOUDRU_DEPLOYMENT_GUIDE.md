# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ Cloud.ru ML Inference

**–í–µ—Ä—Å–∏—è –æ–±—Ä–∞–∑–∞:** 1.0.8  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 05.12.2025

## üì¶ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±—Ä–∞–∑–µ

**Docker Image URI:**
```
docling-granite-258m.cr.cloud.ru/paddleocr-vl-service:latest
```

**–í–µ—Ä—Å–∏—è —Å —Ç–µ–≥–æ–º:**
```
docling-granite-258m.cr.cloud.ru/paddleocr-vl-service:1.0.8
```

**Digest:**
```
sha256:517c7cc435e81889905d7a3bfc03846ec4a2a5b308cb8bfb34d0c752ff918fb6
```

**–†–∞–∑–º–µ—Ä:** ~20.5GB

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è ML Inference

### 1. Docker Image URI
```
docling-granite-258m.cr.cloud.ru/paddleocr-vl-service:latest
```

### 2. –ü–æ—Ä—Ç—ã

**–û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã:**
- **8081** - FastAPI handler (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å OCR)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–æ—Ä—Ç 8080 (vLLM) –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### 3. Health Check –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**Liveness Probe:**
```
Path: /health
Port: 8081
Initial Delay: 180 —Å–µ–∫—É–Ω–¥
Period: 30 —Å–µ–∫—É–Ω–¥
Timeout: 10 —Å–µ–∫—É–Ω–¥
Failure Threshold: 3
```

**Readiness Probe:**
```
Path: /health
Port: 8081
Initial Delay: 240 —Å–µ–∫—É–Ω–¥
Period: 15 —Å–µ–∫—É–Ω–¥
Timeout: 5 —Å–µ–∫—É–Ω–¥
Failure Threshold: 3
```

**Startup Probe (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```
Path: /health
Port: 8081
Initial Delay: 0 —Å–µ–∫—É–Ω–¥
Period: 15 —Å–µ–∫—É–Ω–¥
Timeout: 10 —Å–µ–∫—É–Ω–¥
Failure Threshold: 40 (–¥–æ 10 –º–∏–Ω—É—Ç –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é)
Success Threshold: 1
```

### 4. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Cloud.ru Object Storage:**
```bash
CLOUDRU_S3_ENDPOINT=https://s3.cloud.ru
CLOUDRU_S3_BUCKET=bucket-winners223
CLOUDRU_S3_ACCESS_KEY=your-access-key
CLOUDRU_S3_SECRET_KEY=your-secret-key
```

–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –∑–∞–¥–∞–Ω—ã, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ –≤ `/app/output`.

### 5. –†–µ—Å—É—Ä—Å—ã

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ:**
- **CPU:** 4+ cores
- **Memory:** 16GB+ RAM
- **GPU:** 1x NVIDIA GPU (CUDA 12.6+)
- **Storage:** 10GB+ –¥–ª—è –º–æ–¥–µ–ª–µ–π –∏ –∫—ç—à–∞

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ:**
- **CPU:** 2 cores
- **Memory:** 8GB RAM
- **GPU:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è (–¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### 1. Health Check

```bash
curl -H "Authorization: Bearer YOUR_API_KEY" \
  https://your-endpoint.cloud.ru/health
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
    "status": "healthy",
    "paddleocr": "not_initialized",
    "s3_storage": "configured",
    "output_dir": "/app/output",
    "temp_dir": "/app/temp",
    "docs": "/docs - Swagger UI –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API"
}
```

### 2. –ö–æ—Ä–Ω–µ–≤–æ–π endpoint

```bash
curl -H "Authorization: Bearer YOUR_API_KEY" \
  https://your-endpoint.cloud.ru/
```

### 3. Swagger UI

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://your-endpoint.cloud.ru/docs
```

## üìù –í–∞–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ä—Å–∏–∏ 1.0.8

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

1. ‚úÖ **–£–±—Ä–∞–Ω vLLM —Å–µ—Ä–≤–µ—Ä** - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
2. ‚úÖ **–£–ø—Ä–æ—â–µ–Ω –∑–∞–ø—É—Å–∫** - —Ç–æ–ª—å–∫–æ FastAPI handler
3. ‚úÖ **–û–¥–∏–Ω –ø–æ—Ä—Ç** - 8081 (–±—ã–ª–æ 8080 –∏ 8081)

### –ü–æ—á–µ–º—É:

- vLLM –Ω–µ –º–æ–∂–µ—Ç —Å–∫–∞—á–∞—Ç—å –º–æ–¥–µ–ª—å –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º
- –ú—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º vLLM –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –Ω–µ–º—É)
- FastAPI —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ PaddlePaddle –Ω–∞–ø—Ä—è–º—É—é

### –í–ª–∏—è–Ω–∏–µ:

- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –∑–∞–ø—É—Å–∫ (–Ω–µ—Ç –ø–æ–ø—ã—Ç–æ–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å vLLM)
- ‚úÖ –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ (–±–µ–∑ vLLM —É—Å–∫–æ—Ä–µ–Ω–∏—è)
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–µ–µ —Ä–∞–±–æ—Ç–∞

## üöÄ –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ:

1. ‚úÖ FastAPI handler –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É
2. ‚úÖ Health check –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ ~5 —Å–µ–∫—É–Ω–¥
3. ‚úÖ PaddleOCR-VL –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ

### –ü—Ä–∏ –ø–µ—Ä–≤–æ–º OCR –∑–∞–ø—Ä–æ—Å–µ:

1. ‚è≥ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PaddleOCR-VL (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 30-60 —Å–µ–∫—É–Ω–¥)
2. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã:

- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ (–º–æ–¥–µ–ª—å —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞)
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞

## üìã API Endpoints

### `GET /health`
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞

### `GET /`
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### `POST /ocr`
–û—Å–Ω–æ–≤–Ω–æ–π endpoint –¥–ª—è OCR –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `image_base64` (—Å—Ç—Ä–æ–∫–∞) - Base64-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- `image_url` (—Å—Ç—Ä–æ–∫–∞) - URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `file` (—Ñ–∞–π–ª) - Multipart –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞

### `GET /docs`
Swagger UI –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### `GET /redoc`
ReDoc –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: Health check –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á–∏—Ç—å `initialDelaySeconds` –¥–æ 180-240 —Å–µ–∫—É–Ω–¥
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–µ—Ä–≤—ã–π OCR –∑–∞–ø—Ä–æ—Å –æ—á–µ–Ω—å –¥–æ–ª–≥–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏
- –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –±—ã—Å—Ç—Ä–µ–µ

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ –æ–±—Ä–∞–∑–µ)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- [ ] –û–±—Ä–∞–∑ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Artifact Registry
- [ ] Docker Image URI –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ü–æ—Ä—Ç 8081 –æ—Ç–∫—Ä—ã—Ç
- [ ] Health check –Ω–∞—Å—Ç—Ä–æ–µ–Ω (initial delay: 180+ —Å–µ–∫—É–Ω–¥)
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è S3 (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
- [ ] –†–µ—Å—É—Ä—Å—ã –≤—ã–¥–µ–ª–µ–Ω—ã (CPU, Memory, GPU)
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π health check –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π OCR –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω

## üìß –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check endpoint
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å GPU
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

