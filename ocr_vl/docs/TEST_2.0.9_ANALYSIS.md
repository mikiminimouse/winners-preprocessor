# –ê–Ω–∞–ª–∏–∑ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–µ—Ä—Å–∏–∏ 2.0.9

**–î–∞—Ç–∞:** 2025-12-10  
**–í–µ—Ä—Å–∏—è –æ–±—Ä–∞–∑–∞:** 2.0.9  
**URL:** https://08d022b0-2b04-4a35-adb0-10b35daafed5.modelrun.inference.cloud.ru

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. Health Check
- ‚úÖ **–°—Ç–∞—Ç—É—Å:** 200 OK
- ‚úÖ **Service:** healthy
- ‚úÖ **PaddleOCR:** ready
- ‚úÖ **S3 Storage:** configured (–∫–ª–∏–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω)

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
- ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ú–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
- ‚úÖ S3 –∫–ª–∏–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

---

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: 502 Gateway Timeout

### –û–ø–∏—Å–∞–Ω–∏–µ

- **–°—Ç–∞—Ç—É—Å:** 502 Gateway Timeout
- **–í—Ä–µ–º—è –¥–æ —Ç–∞–π–º–∞—É—Ç–∞:** 89 —Å–µ–∫—É–Ω–¥
- **–§–∞–π–ª—ã –≤ S3:** –ù–µ –Ω–∞–π–¥–µ–Ω—ã

### –ê–Ω–∞–ª–∏–∑ —Å–∏—Ç—É–∞—Ü–∏–∏

**502 Gateway Timeout –æ–∑–Ω–∞—á–∞–µ—Ç:**
1. ‚úÖ –ó–∞–ø—Ä–æ—Å –ø—Ä–∏–Ω—è—Ç —Å–µ—Ä–≤–µ—Ä–æ–º
2. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—á–∞–ª–∞—Å—å
3. ‚ùå Gateway –æ–±—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. ‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ, –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ—Å–ª–µ –æ–±—Ä—ã–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å:**
- –ó–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ—Å–ª–µ 502?
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ª–∏ —Ñ–∞–π–ª—ã –≤ S3, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ 502?
- –ò–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º?

---

## üîç –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

### –í Cloud.ru Console ‚Üí –õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏—â–∏—Ç–µ:

#### 1. –õ–æ–≥–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ S3:
```
‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- "S3 bucket verified: bucket-winners223 (correct)"
- "‚úÖ S3 client initialized successfully"
- "‚úÖ S3 bucket access verified" (–∏–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å)
```

#### 2. –õ–æ–≥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ—Å–ª–µ 06:46:45):
```
–ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:
- "Processing image with PaddleOCR-VL: /app/temp/..."
- "PaddleOCR-VL processing completed successfully"
- "Results saved locally: ..."
- "Verifying local files before S3 upload:"
- "‚úÖ Markdown file created successfully: XXX bytes"
- "‚úÖ JSON file created successfully: XXX bytes"
- "S3 upload started: bucket=bucket-winners223"
- "‚úÖ Markdown uploaded: s3://bucket-winners223/..."
- "‚úÖ JSON uploaded: s3://bucket-winners223/..."
- "‚úÖ S3 upload completed successfully"
```

#### 3. –û—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å):
```
‚ùå "S3 upload failed: ..."
‚ùå "Markdown file not found"
‚ùå "JSON file is empty"
‚ùå "PaddleOCR processing failed: ..."
```

---

## üìä –í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, S3 –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –≤ –ª–æ–≥–∞—Ö:**
- –í–∏–¥–Ω—ã —Å—Ç—Ä–æ–∫–∏ "S3 upload completed successfully"
- –í–∏–¥–Ω—ã —Å—Ç—Ä–æ–∫–∏ "‚úÖ Markdown uploaded", "‚úÖ JSON uploaded"

**–î–µ–π—Å—Ç–≤–∏–µ:**
- –§–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ S3, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ 502
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å S3 —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –∑–∞–ø—Ä–æ—Å–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: Gateway –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –≤ –ª–æ–≥–∞—Ö:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è, –Ω–æ –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è
- –ù–µ—Ç –ª–æ–≥–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ù–µ—Ç –ª–æ–≥–æ–≤ S3 –∑–∞–≥—Ä—É–∑–∫–∏

**–î–µ–π—Å—Ç–≤–∏–µ:**
- –£–≤–µ–ª–∏—á–∏—Ç—å Gateway Timeout
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, –Ω–æ S3 –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –≤ –ª–æ–≥–∞—Ö:**
- –í–∏–¥–Ω—ã —Å—Ç—Ä–æ–∫–∏ "Results saved locally"
- –í–∏–¥–Ω—ã —Å—Ç—Ä–æ–∫–∏ "S3 upload failed" –∏–ª–∏ –æ—à–∏–±–∫–∏ S3

**–î–µ–π—Å—Ç–≤–∏–µ:**
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É S3 (credentials, –ø—Ä–∞–≤–∞, —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–µ–π)

---

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ Cloud.ru Console:**
   - –ù–∞–π—Ç–∏ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—Ä–æ—Å–∞ (–ø—Ä–∏–º–µ—Ä–Ω–æ 06:46:45 + –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å –ª–∏ —Ñ–∞–π–ª—ã –≤ S3

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å S3 —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç:**
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –æ–±—Ä—ã–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
   - –§–∞–π–ª—ã –º–æ–≥—É—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –≤ S3 –ø–æ–∑–∂–µ

3. **–£–≤–µ–ª–∏—á–∏—Ç—å Gateway Timeout:**
   - –í Cloud.ru Console ‚Üí ML Inference ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏
   - –ò—Å–∫–∞—Ç—å: "Ingress Settings", "Gateway Settings"
   - –£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ **300-600 —Å–µ–∫—É–Ω–¥**

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏:

–ï—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ:
- ‚úÖ "S3 upload completed successfully" ‚Üí —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ S3
- ‚ùå "S3 upload failed" ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ —Å S3, –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å
- ‚ùå –ù–µ—Ç –ª–æ–≥–æ–≤ S3 ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è gateway timeout

---

## üìù –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ S3

```bash
python3 - <<'PY'
import boto3
from datetime import datetime, timedelta

s3 = boto3.client(
    's3',
    endpoint_url='https://s3.cloud.ru',
    aws_access_key_id='502f76f0-9017-493d-bda4-9e1bb278da84:ce94860ccc8780b2bc5f00f31459d24e',
    aws_secret_access_key='759469c88d6e450b584e2487c5174770',
    region_name='ru-central-1'
)

# –§–∞–π–ª—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
objects = s3.list_objects_v2(Bucket='bucket-winners223', Prefix='ocr-results/')
if 'Contents' in objects:
    now = datetime.now(objects['Contents'][0]['LastModified'].tzinfo)
    recent = [obj for obj in objects['Contents'] 
              if (now - obj['LastModified']).total_seconds() < 3600]
    
    print(f"–§–∞–π–ª—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å: {len(recent)}")
    for obj in sorted(recent, key=lambda x: x['LastModified'], reverse=True):
        print(f"  {obj['Key']} - {obj['Size']} bytes - {obj['LastModified']}")
else:
    print("–§–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
PY
```

---

## ‚úÖ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** (–≥–ª–∞–≤–Ω–æ–µ!)
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å S3 —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç** –ø–æ—Å–ª–µ –∑–∞–ø—Ä–æ—Å–∞
3. **–£–≤–µ–ª–∏—á–∏—Ç—å Gateway Timeout** –¥–æ 300-600 —Å–µ–∫—É–Ω–¥
4. **–ü–æ–≤—Ç–æ—Ä–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –ø–æ—Å–ª–µ —É–≤–µ–ª–∏—á–µ–Ω–∏—è timeout

---

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ Cloud.ru Console - –æ–Ω–∏ –ø–æ–∫–∞–∂—É—Ç, –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ª–∏ —Ñ–∞–π–ª—ã –≤ S3 –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ 502 Gateway Timeout.

