# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã S3 –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

**–î–∞—Ç–∞:** 2025-12-10  
**–ü—Ä–æ–±–ª–µ–º–∞:** S3 –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

---

## üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

### –û—à–∏–±–∫–∞ –≤ –ª–æ–≥–∞—Ö:
```
‚ö†Ô∏è S3 bucket access test failed (but client initialized, will try upload anyway): 
Could not connect to the endpoint URL: "https://s3.cloud.ru/bucket-winners223?list-type=2&max-keys=1&encoding-type=url"
```

### –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–∫–∏:

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è boto3**
   - boto3 –ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `https://s3.cloud.ru/bucket-winners223?...`
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `https://s3.cloud.ru` (endpoint) + bucket –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∑–∞–ø—Ä–æ—Å–∞

2. **–ü—Ä–∏—á–∏–Ω–∞:**
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `Config` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
   - boto3 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç virtual-hosted style URLs –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - Cloud.ru S3 –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å path-style URLs

3. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `signature_version='s3v4'`**
   - Cloud.ru S3 —Ç—Ä–µ–±—É–µ—Ç S3v4 signature
   - –ë–µ–∑ —ç—Ç–æ–≥–æ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ:

1. **–î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç Config:**
   ```python
   from botocore.client import Config
   ```

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
   ```python
   s3_config = Config(
       signature_version='s3v4',
       s3={
           'addressing_style': 'path'  # path-style URLs –≤–º–µ—Å—Ç–æ virtual-hosted
       }
   )
   
   s3_client = boto3.client(
       's3',
       endpoint_url=CLOUDRU_S3_ENDPOINT,
       aws_access_key_id=CLOUDRU_S3_ACCESS_KEY,
       aws_secret_access_key=CLOUDRU_S3_SECRET_KEY,
       region_name=CLOUDRU_S3_REGION or "ru-central-1",
       config=s3_config,
       use_ssl=True
   )
   ```

### –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ?

**–õ–æ–∫–∞–ª—å–Ω–æ:**
- –í–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–π endpoint
- –ò–ª–∏ –¥—Ä—É–≥–∞—è —Å–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –ò–ª–∏ –¥—Ä—É–≥–∞—è –≤–µ—Ä—Å–∏—è boto3

**–í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:**
- –î—Ä—É–≥–∞—è —Å–µ—Ç–µ–≤–∞—è —Å—Ä–µ–¥–∞
- –í–æ–∑–º–æ–∂–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–µ—Ç–∏
- boto3 –º–æ–∂–µ—Ç –ø–æ-–¥—Ä—É–≥–æ–º—É —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å URLs

---

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `Config` —Å `signature_version='s3v4'`
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `addressing_style='path'` –¥–ª—è path-style URLs
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `use_ssl=True` —è–≤–Ω–æ
4. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è bucket

---

## üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**
   ```bash
   # –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
   curl -I https://s3.cloud.ru
   ping s3.cloud.ru
   nslookup s3.cloud.ru
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   env | grep CLOUDRU_S3
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å DNS —Ä–µ–∑–æ–ª—é—Ü–∏—é:**
   - –í–æ–∑–º–æ–∂–Ω–æ DNS –Ω–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç `s3.cloud.ru` –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Cloud.ru ML Inference

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall/security groups:**
   - –í–æ–∑–º–æ–∂–Ω–æ –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ S3 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
   - –ù—É–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ `s3.cloud.ru:443`

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥** (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
2. ‚è≥ **–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑** —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
3. ‚è≥ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
4. ‚è≥ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–æ–≤—ã—Ö –æ—à–∏–±–æ–∫

---

## üìù –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```python
s3_client = boto3.client(
    's3',
    endpoint_url=CLOUDRU_S3_ENDPOINT,
    aws_access_key_id=CLOUDRU_S3_ACCESS_KEY,
    aws_secret_access_key=CLOUDRU_S3_SECRET_KEY,
    region_name=CLOUDRU_S3_REGION or "ru-central-1"
)
```

### –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```python
s3_config = Config(
    signature_version='s3v4',
    s3={'addressing_style': 'path'}
)

s3_client = boto3.client(
    's3',
    endpoint_url=CLOUDRU_S3_ENDPOINT,
    aws_access_key_id=CLOUDRU_S3_ACCESS_KEY,
    aws_secret_access_key=CLOUDRU_S3_SECRET_KEY,
    region_name=CLOUDRU_S3_REGION or "ru-central-1",
    config=s3_config,
    use_ssl=True
)
```

---

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã. –ù—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å.**

