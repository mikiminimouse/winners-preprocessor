# –†–µ–∑—é–º–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ S3 –∑–∞–≥—Ä—É–∑–∫–∏ - –≤–µ—Ä—Å–∏—è 2.0.12

**–î–∞—Ç–∞:** 2025-12-10

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –í—ã–¥–µ–ª–µ–Ω—ã –æ–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `_upload_file_to_s3()` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –æ–¥–∏–Ω —Ñ–∞–π–ª –≤ S3
- –ï–¥–∏–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (ClientError, BotoCoreError)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö URL
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏ (–≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏)

#### `_check_s3_connection()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å bucket
- Fallback –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã (head_bucket ‚Üí list_objects_v2)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

### 2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `upload_to_cloudru()`

**–ë—ã–ª–æ:** ~120 —Å—Ç—Ä–æ–∫ —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º
**–°—Ç–∞–ª–æ:** ~90 —Å—Ç—Ä–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `_upload_file_to_s3()` –¥–ª—è –æ–±–æ–∏—Ö —Ñ–∞–π–ª–æ–≤
- –ï–¥–∏–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞

### 3. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `test_s3_upload()`

**–ë—ã–ª–æ:** ~70 —Å—Ç—Ä–æ–∫ —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º
**–°—Ç–∞–ª–æ:** ~60 —Å—Ç—Ä–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `_upload_file_to_s3()` –∏ `_check_s3_connection()`
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–≥—Ä—É–∑–∫–µ

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è S3

- –î–æ–±–∞–≤–ª–µ–Ω `Config` —Å `signature_version='s3v4'`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `addressing_style='path'` –¥–ª—è path-style URLs
- –î–æ–±–∞–≤–ª–µ–Ω `use_ssl=True`

---

## üìä –£–ª—É—á—à–µ–Ω–∏—è –∫–æ–¥–∞

### –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ ~50 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –≤—ã–Ω–µ—Å–µ–Ω–æ –≤ –æ–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ (ClientError, BotoCoreError)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ö–æ–¥—ã –æ—à–∏–±–æ–∫ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
- ‚úÖ –†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤ (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –≤ S3)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–π:

```
_upload_file_to_s3()
  ‚îú‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ (—Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ, —Ä–∞–∑–º–µ—Ä)
  ‚îú‚îÄ‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3
  ‚îú‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  ‚îî‚îÄ‚îÄ –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

_check_s3_connection()
  ‚îú‚îÄ‚îÄ head_bucket()
  ‚îî‚îÄ‚îÄ list_objects_v2() (fallback)

upload_to_cloudru()
  ‚îú‚îÄ‚îÄ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
  ‚îú‚îÄ‚îÄ _check_s3_connection()
  ‚îú‚îÄ‚îÄ _upload_file_to_s3() –¥–ª—è MD
  ‚îî‚îÄ‚îÄ _upload_file_to_s3() –¥–ª—è JSON

test_s3_upload()
  ‚îú‚îÄ‚îÄ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
  ‚îú‚îÄ‚îÄ _check_s3_connection()
  ‚îî‚îÄ‚îÄ _upload_file_to_s3()
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **DRY (Don't Repeat Yourself)**
   - –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
   - –õ–µ–≥—á–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å

2. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
   - –ï–¥–∏–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

3. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å**
   - –ö–æ–¥ —Å—Ç–∞–ª –ø–æ–Ω—è—Ç–Ω–µ–µ
   - –õ–µ–≥—á–µ –ø–æ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É

4. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**
   - –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
   - –ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## üìã –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ **100% –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- –í—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–∞–∫ –∂–µ
- –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
- –¢–æ–ª—å–∫–æ —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

**–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω. –ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É.**


















