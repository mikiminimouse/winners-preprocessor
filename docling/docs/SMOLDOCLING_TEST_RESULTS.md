# Финальный отчет по тестированию интеграции SmolDocling

## Общая информация

Тестирование интеграции SmolDocling было проведено на трех PDF-файлах различного качества:

1. **UNIT_13bd07b0fa0ef660** - "Протокол рассмотрения и оценки котировочных заявок № 35 от 19.11.2025.pdf" (скан книжного разворота)
2. **UNIT_11c6ba8e496155c1** - "tmp1jp9rv31.pdf" (документ среднего качества, 4 страницы)
3. **UNIT_6e44cf32b40a2035** - "Протокол Труба ПЭ 560.pdf" (документ низкого качества, 2 страницы)

## Результаты тестирования

### 1. UNIT_13bd07b0fa0ef660 (Скан книжного разворота)
- **Статус**: Ошибка 500 Internal Server Error
- **Время обработки**: 8.41 секунд
- **Описание проблемы**: "EngineCore encountered an issue. See stack trace (above) for the root cause."
- **Анализ**: Ошибка на стороне сервера SmolDocling при обработке изображения книжного разворота. Возможно, проблема связана с особенностями формата изображения или сложной структурой сканированного документа.

### 2. UNIT_11c6ba8e496155c1 (Документ среднего качества, 4 страницы)
- **Статус**: Ошибка подключения "connection refused"
- **Время обработки**: 104.78 секунд
- **Описание проблемы**: "dial tcp 127.0.0.1:8080: connect: connection refused"
- **Анализ**: После обработки первой страницы сервер стал недоступен. Это может указывать на:
  - Проблемы с масштабированием при обработке многостраничных документов
  - Превышение лимитов ресурсов сервера
  - Проблемы с управлением состоянием сервера при длительных операциях

### 3. UNIT_6e44cf32b40a2035 (Документ низкого качества, 2 страницы)
- **Статус**: Ошибка подключения "connection refused"
- **Время обработки**: 15.51 секунд
- **Описание проблемы**: "dial tcp 127.0.0.1:8080: connect: connection refused"
- **Анализ**: Сервер стал недоступен после первой же попытки обработки, что подтверждает проблему с масштабированием или стабильностью сервера.

## Выводы

### Технические проблемы
1. **Серверные ошибки**: Первый файл вызвал внутреннюю ошибку сервера (500), что указывает на проблемы в обработке определенных типов изображений.
2. **Проблемы с масштабированием**: После обработки первого файла последующие запросы получают ошибку "connection refused", что свидетельствует о краше или перегрузке сервера.
3. **Нестабильность**: Сервер не смог обработать даже небольшое количество запросов (всего 7 изображений).

### Возможные причины
1. **Ограничения ресурсов**: Сервер может не иметь достаточных ресурсов для обработки нескольких изображений подряд.
2. **Проблемы с управлением состоянием**: Сервер может не корректно освобождать ресурсы после обработки каждого запроса.
3. **Ошибки в реализации**: Внутренние ошибки в коде SmolDocling при обработке сложных изображений.

## Рекомендации

### Для дальнейшего тестирования
1. **Проверка мониторинга**: Необходимо настроить мониторинг состояния сервера во время тестирования.
2. **Индивидуальная обработка**: Попробовать обрабатывать каждый файл по отдельности с перезапуском сервера между тестами.
3. **Оптимизация запросов**: Проверить, поможет ли уменьшение размера изображений или изменение параметров запроса.

### Для улучшения интеграции
1. **Обработка ошибок**: Добавить более подробную обработку ошибок и механизм повторных попыток.
2. **Мониторинг состояния**: Реализовать проверку доступности сервера перед каждым запросом.
3. **Очередь запросов**: Внедрить очередь для обработки документов с контролем нагрузки.

## Заключение

Интеграция SmolDocling столкнулась с серьезными техническими проблемами при тестировании:
- Только первый файл из трех был частично обработан (до ошибки сервера)
- Все остальные файлы не были обработаны из-за недоступности сервера
- Общее время тестирования составило 128.70 секунд, но без получения полезных результатов

Для дальнейшей работы с SmolDocling необходимо решить проблемы стабильности сервера и масштабируемости.
