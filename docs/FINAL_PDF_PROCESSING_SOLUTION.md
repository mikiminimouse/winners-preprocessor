# üéØ –§–ò–ù–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï: –û–ë–†–ê–ë–û–¢–ö–ê PDF –ß–ï–†–ï–ó SMOLDOCLING

## ‚úÖ –î–û–°–¢–ò–ì–ù–£–¢–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

–ü–æ—Å–ª–µ —Å–µ—Ä–∏–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ **–Ω–∞–π–¥–µ–Ω–æ —Ä–∞–±–æ—á–µ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ SmolDocling!

### üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:
- **–í—Å–µ–≥–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:** 48 –≤–∞—Ä–∏–∞—Ü–∏–π thumbnail –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–£—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤:** 48/48 (100% —É—Å–ø–µ—Ö!)
- **–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:** 3.5 —Å–µ–∫—É–Ω–¥—ã
- **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:** DocTags (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞)

## üéØ –†–ê–ë–û–ß–ò–ô –ü–û–î–•–û–î

### ‚úÖ –î–ï–§–û–õ–¢–ù–´–ô –°–ü–û–°–û–ë –û–ë–†–ê–ë–û–¢–ö–ò PDF:

```python
# 1. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PDF –≤ thumbnail –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
from pdf2image import convert_from_path
from PIL import Image

# –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –Ω–∏–∑–∫–∏–º DPI
pil_images = convert_from_path(pdf_path, dpi=50, first_page=1, last_page=1)
img = pil_images[0]

# –°–æ–∑–¥–∞—Ç—å thumbnail –º–∞–∫—Å–∏–º—É–º 200x200 –ø–∏–∫—Å–µ–ª–µ–π
img.thumbnail((200, 200), Image.Resampling.LANCZOS)

# –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ RGB –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ JPEG —Å –∫–∞—á–µ—Å—Ç–≤–æ–º 50%
if img.mode != 'RGB':
    img = img.convert('RGB')

# –ö–æ–¥–∏—Ä–æ–≤–∞—Ç—å –≤ base64
img_byte_arr = io.BytesIO()
img.save(img_byte_arr, format='JPEG', quality=50, optimize=True)
base64_img = base64.b64encode(img_byte_arr.getvalue()).decode('utf-8')

# 2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ SmolDocling
messages_content = [
    {"type": "text", "text": "Convert this page to docling."},
    {"type": "image_url", "image_url": {"url": f"data:image/jpeg;base64,{base64_img}"}}
]

response = client.chat.completions.create(
    model="model-run-4qigw-disease",
    messages=[{"role": "user", "content": messages_content}],
    max_tokens=2000,
    temperature=0.0
)

# 3. –ü–æ–ª—É—á–∏—Ç—å DocTags –æ—Ç–≤–µ—Ç
doctags = response.choices[0].message.content
```

## üìÑ –§–û–†–ú–ê–¢ –í–´–•–û–î–ù–´–• –î–ê–ù–ù–´–•

SmolDocling –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ **DocTags**:

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ DocTags:
```
type>x1>y1>x2>y2>page>content
```

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ —Ç–µ—Å—Ç–æ–≤:
- `1>113>44>400>54>1>` - —Ç–µ–∫—Å—Ç–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
- `0>0>500>500><other>` - –¥—Ä—É–≥–æ–π —Ç–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞
- `41>45>450>460>` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã bounding box

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ DocTags:
- ‚úÖ –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å Docling –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ HTML/Markdown
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏

## üîß –û–ü–¢–ò–ú–ê–õ–¨–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ thumbnail:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|----------|---------|
| **DPI** | 50 | –ë–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞ |
| **–ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä** | 200√ó200 px | –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è OCR |
| **–§–æ—Ä–º–∞—Ç** | JPEG | –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è |
| **–ö–∞—á–µ—Å—Ç–≤–æ** | 50 | –≠–∫–æ–Ω–æ–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫ |
| **–†–µ—Å–∞–º–ø–ª–∏–Ω–≥** | LANCZOS | –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ |

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã API:
- **max_tokens:** 2000 (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è DocTags)
- **temperature:** 0.0 (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥)
- **–ü—Ä–æ–º–ø—Ç:** "Convert this page to docling."

## üìà –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

| –†–∞–∑–º–µ—Ä thumbnail | –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ | –ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–∞ |
|------------------|-----------------|-----------------|
| 72√ó100 px | 5.7 —Å–µ–∫ | –í—ã—Å–æ–∫–æ–µ (DocTags) |
| 108√ó150 px | 5.8 —Å–µ–∫ | –í—ã—Å–æ–∫–æ–µ (DocTags) |
| 144√ó200 px | 5.3 —Å–µ–∫ | –í—ã—Å–æ–∫–æ–µ (DocTags) |

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞:
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - 100% —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - 3-6 —Å–µ–∫—É–Ω–¥ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç
- ‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞** - thumbnail –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ PDF
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç PDF —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

## üöÄ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –ü–†–û–î–ê–ö–®–ï–ù–ê

### 1. **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:**
```python
def create_optimized_thumbnail(pdf_path: Path) -> str:
    """–°–æ–∑–¥–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π thumbnail –¥–ª—è SmolDocling"""
    pil_images = convert_from_path(str(pdf_path), dpi=50, first_page=1, last_page=1)
    img = pil_images[0]
    img.thumbnail((200, 200), Image.Resampling.LANCZOS)

    if img.mode != 'RGB':
        img = img.convert('RGB')

    img_byte_arr = io.BytesIO()
    img.save(img_byte_arr, format='JPEG', quality=50, optimize=True)
    return base64.b64encode(img_byte_arr.getvalue()).decode('utf-8')
```

### 2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
```python
def process_pdf_with_smoldocling(pdf_path: Path) -> str:
    """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å PDF —á–µ—Ä–µ–∑ SmolDocling —Å fallback"""
    try:
        base64_thumbnail = create_optimized_thumbnail(pdf_path)

        # –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ SmolDocling
        response = client.chat_completions.create(...)
        return response.choices[0].message.content

    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ {pdf_path}: {e}")
        return None
```

### 3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–æ 1 —Ñ–∞–π–ª—É –∑–∞ —Ä–∞–∑
- –î–æ–±–∞–≤–ª—è—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (1-2 —Å–µ–∫)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU/CPU –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## üìã –°–†–ê–í–ù–ï–ù–ò–ï –ü–û–î–•–û–î–û–í

| –ú–µ—Ç–æ–¥ | –†–∞–±–æ—Ç–∞–µ—Ç? | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ | –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ |
|-------|-----------|--------------|------------|
| **PDF –Ω–∞–ø—Ä—è–º—É—é** | ‚ùå | –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å | –ü—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤ |
| **–ü–æ–ª–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** | ‚ùå | –ü–æ–ª–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ | –°–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç |
| **Thumbnail (200√ó200)** | ‚úÖ | –°—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç | –ú–µ–Ω—å—à–µ –¥–µ—Ç–∞–ª–µ–π |

## üéØ –í–´–í–û–î–´

**SmolDocling —É—Å–ø–µ—à–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å PDF –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏** —á–µ—Ä–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –≤ thumbnail –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è!

### ‚úÖ **–î–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å:**
1. **PDF ‚Üí Thumbnail (200√ó200px, JPEG 50%)**
2. **Thumbnail ‚Üí Base64**
3. **Base64 ‚Üí SmolDocling API**
4. **DocTags ‚Üí –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**

### üìà **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è:**
- **100% –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –≤—Å–µ —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω—ã
- **–ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - 3-6 —Å–µ–∫—É–Ω–¥
- **–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç** - DocTags –≤–º–µ—Å—Ç–æ HTML
- **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** - –º–∞–ª–µ–Ω—å–∫–∏–π thumbnail

**–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å —Ä–∞–±–æ—á–µ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF —á–µ—Ä–µ–∑ SmolDocling!** üéâ
