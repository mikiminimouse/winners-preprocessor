# –ü–û–î–†–û–ë–ù–´–ô –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –û–¢–ß–ï–¢ –ü–†–û–ï–ö–¢–ê WINNERS223

## –í–í–ï–î–ï–ù–ò–ï –ò –û–ë–ó–û–† –ü–†–û–ï–ö–¢–ê

### –¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏ —Å–∏—Å—Ç–µ–º—ã

–ü—Ä–æ–µ–∫—Ç Winners223 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –≤ —Ç–µ–Ω–¥–µ—Ä–∞—Ö –§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–∞ ‚Ññ223-–§–ó. –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∑–∞–∫—É–ø–æ–∫ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ–Ω–¥–µ—Ä–æ–≤.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Å–∏—Å—Ç–µ–º—ã:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∑–∞–∫—É–ø–æ–∫ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è—Ö —Ç–µ–Ω–¥–µ—Ä–æ–≤
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –≤—ã—Å–æ–∫–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

### –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —ç–≤–æ–ª—é—Ü–∏—è

–ü—Ä–æ–µ–∫—Ç –ø—Ä–æ—à–µ–ª —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤ —Ä–∞–∑–≤–∏—Ç–∏—è:

1. **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Ñ–∞–∑–∞** (–∫–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è)
   - –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ OCR –∏ ML
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SmolDocling —á–µ—Ä–µ–∑ Cloud.ru API
   - –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –ª–æ–∫–∞–ª—å–Ω—ã–º Docling

2. **–ü–∏–ª–æ—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è** (pilot_winers223/)
   - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Router, Docling, Downloader, Scheduler
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

3. **–§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è** (final_pilot_Winers223/)
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
   - Decision Engine —Å —Ç—Ä–µ–º—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –∏—Å—Ç–∏–Ω—ã
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ ambiguous —Ñ–∞–π–ª–æ–≤

4. **Cloud.ru –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** (cloudru_service/)
   - –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Granite-Docling
   - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π Cloud.ru
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è API –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

### –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Input     ‚îÇ ‚Üí –§–∞–π–ª—ã (PDF, DOC, DOCX, –∞—Ä—Ö–∏–≤—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Router/Preprocessor                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ (magic/mimetype)     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ 2. –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ 3. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è PDF (text/scan)         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ 4. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è DOC‚ÜíDOCX (LibreOffice)   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ 5. –°–æ–∑–¥–∞–Ω–∏–µ manifest.json                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ 6. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è unit'–æ–≤                 ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Docling Pipeline                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Route: pdf_text ‚Üí Text Extraction         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ Route: pdf_scan ‚Üí OCR ‚Üí Layout ‚Üí Tables  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ Route: docx ‚Üí Text Extraction ‚Üí Layout   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ Route: image ‚Üí OCR ‚Üí Layout ‚Üí Tables     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ Route: mixed ‚Üí –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Output    ‚îÇ ‚Üí JSON, Markdown, HTML
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ê–†–•–ò–¢–ï–ö–¢–£–†–´

### –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **Router/Preprocessor** (FastAPI)
   - **–ó–∞–¥–∞—á–∏:** –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤, –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞, —Å–æ–∑–¥–∞–Ω–∏–µ unit'–æ–≤
   - **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** FastAPI, python-magic, pypdf, 7z/unzip
   - **API endpoints:** `/upload`, `/webhook`, `/process_now`, `/status/{unit_id}`

2. **Docling** (Python service)
   - **–ó–∞–¥–∞—á–∏:** OCR, Text Extraction, Layout Analysis, Table Extraction
   - **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** Docling SDK, OCR –º–æ–¥–µ–ª–∏
   - **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:** CPU-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏, —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ DigitalOcean

3. **LibreOffice** (Docker service)
   - **–ó–∞–¥–∞—á–∏:** –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è DOC ‚Üí DOCX
   - **–†–µ–∂–∏–º:** Headless, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

4. **Scheduler** (APScheduler)
   - **–ó–∞–¥–∞—á–∏:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ cron
   - **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

5. **MongoDB** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ PostgreSQL)
   - **–ó–∞–¥–∞—á–∏:** –•—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, manifest'–æ–≤, –º–µ—Ç—Ä–∏–∫
   - **–ö–æ–ª–ª–µ–∫—Ü–∏–∏:** `docling_metadata.manifests`, `docling_metadata.processing_metrics`

#### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
Input Files ‚Üí Router API ‚Üí MongoDB (manifests)
                    ‚Üì
              Docling Service ‚Üí MongoDB (results)
                    ‚Üì
              Output Files (JSON/Markdown)
```

#### –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**–ü–æ—Ç–æ–∫ 1: PDF —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º —Å–ª–æ–µ–º**
```
PDF (text) ‚Üí Router ‚Üí detect_type ‚Üí needs_ocr=false
  ‚Üí Normalized Unit ‚Üí Docling ‚Üí Text Extraction
  ‚Üí Layout Analysis ‚Üí Table Extraction ‚Üí Export
```

**–ü–æ—Ç–æ–∫ 2: PDF —Å–∫–∞–Ω**
```
PDF (scan) ‚Üí Router ‚Üí detect_type ‚Üí needs_ocr=true
  ‚Üí Normalized Unit ‚Üí Docling ‚Üí OCR (Docling OCR)
  ‚Üí Layout Analysis ‚Üí Table Extraction ‚Üí Export
```

**–ü–æ—Ç–æ–∫ 3: DOC —Ñ–∞–π–ª**
```
DOC ‚Üí Router ‚Üí detect_type ‚Üí requires_conversion=true
  ‚Üí LibreOffice ‚Üí DOCX ‚Üí Normalized Unit
  ‚Üí Docling ‚Üí Text Extraction ‚Üí Layout ‚Üí Tables ‚Üí Export
```

**–ü–æ—Ç–æ–∫ 4: –ê—Ä—Ö–∏–≤ (ZIP/RAR)**
```
Archive ‚Üí Router ‚Üí detect_type ‚Üí is_archive=true
  ‚Üí Extract ‚Üí Process each file
  ‚Üí Create Unit with multiple files
  ‚Üí Docling ‚Üí Process each file ‚Üí Merge results
```

### –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö (manifest.json, –º–µ—Ç—Ä–∏–∫–∏)

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ manifest.json
```json
{
  "unit_id": "UNIT_abc123",
  "created_at": "2025-01-17T10:00:00",
  "processing": {
    "status": "ready|processing|done|error",
    "route": "pdf_scan|pdf_text|docx|image_ocr|mixed"
  },
  "files": [
    {
      "file_id": "uuid",
      "original_name": "document.pdf",
      "path": "/app/normalized/UNIT_abc123/files/document.pdf",
      "detected_type": "pdf|docx|doc|image|html",
      "mime_type": "application/pdf",
      "needs_ocr": true|false,
      "requires_conversion": true|false,
      "sha256": "hash",
      "size": 12345
    }
  ],
  "archive": {
    "is_archive": true|false,
    "archive_id": "ARCHIVE_xyz",
    "original_path": "/app/input/archive.zip",
    "extracted_count": 2
  }
}
```

#### –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏** –ø–æ —ç—Ç–∞–ø–∞–º (text_extraction, ocr, layout_analysis)
- **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å** –ø–æ —Ç–∏–ø–∞–º —Ñ–∞–π–ª–æ–≤
- **–†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤** –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫** (pdfplumber, python-docx, beautifulsoup)

---

## –ê–ù–ê–õ–ò–ó –ö–û–ú–ü–û–ù–ï–ù–¢–û–í

### Router/Preprocessor: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞, –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è

#### –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤** (True Type Detector)
   - –¢—Ä–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏—Å—Ç–∏–Ω—ã: MIME, Magic Bytes, Extension
   - Decision Engine —Å 7 —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏ ambiguous —Å–ª—É—á–∞–µ–≤

2. **–†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ZIP, RAR (–≤–∫–ª—é—á–∞—è RAR5)
   - –ó–∞—â–∏—Ç–∞ –æ—Ç zip bomb (–ª–∏–º–∏—Ç—ã —Ä–∞–∑–º–µ—Ä–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤)
   - –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤

3. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è PDF**
   - –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–ª–æ—è —á–µ—Ä–µ–∑ pypdf
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ needs_ocr —Ñ–ª–∞–≥–∞

4. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è DOC‚ÜíDOCX**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ LibreOffice
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –Ω–∞ –Ω–∞–ª–∏—á–∏–µ .doc —Ñ–∞–π–ª–æ–≤

5. **–°–æ–∑–¥–∞–Ω–∏–µ manifest.json**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö unit_id
   - –°–≤—è–∑—ã–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ –∞—Ä—Ö–∏–≤–æ–≤
   - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è Docling pipeline

6. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è unit'–æ–≤**
   - –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ unit'–∞
   - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ normalized —Å—Ç—Ä—É–∫—Ç—É—Ä—É
   - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ Docling

### Docling: OCR, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞, layout analysis

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **Text Extraction:** –î–ª—è PDF —Å —Ç–µ–∫—Å—Ç–æ–º –∏ DOCX —Ñ–∞–π–ª–æ–≤
- **OCR:** –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Docling OCR (–Ω–µ Tesseract)
- **Layout Analysis:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤, –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, reading order
- **Table Extraction:** –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- **Export:** JSON, Markdown, HTML —Ñ–æ—Ä–º–∞—Ç—ã

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- CPU-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö routes –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MongoDB –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã

### Decision Engine: —Ç—Ä–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏—Å—Ç–∏–Ω—ã, 7 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

#### –¢—Ä–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏—Å—Ç–∏–Ω—ã:

1. **MIME Type** (python-magic)
   - –ê–Ω–∞–ª–∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Ñ–∞–π–ª–æ–≤
   - –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

2. **Magic Bytes** (—Å–∏–≥–Ω–∞—Ç—É—Ä—ã)
   - –ü–µ—Ä–≤—ã–µ –±–∞–π—Ç—ã —Ñ–∞–π–ª–∞
   - –¢–æ—á–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (100% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Office –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (DOCX –∫–∞–∫ ZIP)

3. **File Extension**
   - –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
   - –ù–∏–∑–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤

#### 7 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π:

1. **–í—Å–µ —Ç—Ä–∏ —Å–æ–≤–ø–∞–ª–∏** ‚Üí –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
2. **MIME+Signature —Å–æ–≤–ø–∞–ª–∏, Extension –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è** ‚Üí –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
3. **MIME –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è, Signature+Extension —Å–æ–≤–ø–∞–ª–∏** ‚Üí –î–æ–≤–µ—Ä–∏–µ Signature
4. **Signature –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è, MIME+Extension —Å–æ–≤–ø–∞–ª–∏** ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ confidence MIME
5. **–í—Å–µ —Ç—Ä–∏ —Ä–∞–∑–Ω—ã–µ** ‚Üí –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç Signature, –∑–∞—Ç–µ–º MIME
6. **MIME –≤–µ—Ä–Ω—É–ª octet-stream** ‚Üí Fallback –∫ Signature/Extension
7. **Signature –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç** ‚Üí Fallback –∫ MIME/Extension

### Ambiguous Handler: fallback –æ–±—Ä–∞–±–æ—Ç–∫–∞

#### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ ambiguous —Ñ–∞–π–ª–æ–≤:
- **–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
- **Manual override** —á–µ—Ä–µ–∑ API
- **Fallback –∫ –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ–º—É —Ç–∏–ø—É**
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

---

## –†–ï–®–ï–ù–ù–´–ï –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤: –ª–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã MIME/Signature/Extension

#### –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º—ã:
- –§–∞–π–ª—ã —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ (.doc –≤–º–µ—Å—Ç–æ .zip)
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –º–µ–∂–¥—É MIME type –∏ —Ä–µ–∞–ª—å–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º
- –§–µ–π–∫–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (HTML –≤ .doc —Ñ–∞–π–ª–∞—Ö)
- OLE2 —Ñ–æ—Ä–º–∞—Ç—ã —Å—Ç–∞—Ä—ã—Ö .doc —Ñ–∞–π–ª–æ–≤

#### –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é:

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏—Å—Ç–∏–Ω—ã:**
```python
def collect_three_sources(file_path: Path) -> Dict[str, Any]:
    return {
        "mime": detect_by_magic(file_path),
        "signature": detect_by_signature(file_path),
        "extension": detect_by_extension(file_path)
    }
```

**Decision Engine —Å 7 —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏:**
- –ê–Ω–∞–ª–∏–∑ confidence –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (Signature > MIME > Extension)
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –ø—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏

**–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤:**
- ZIP-–ø–æ–¥–æ–±–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (DOCX, XLSX, PPTX)
- –§–µ–π–∫–æ–≤—ã–µ DOC —Ñ–∞–π–ª—ã (RAR/Zip/HTML)
- –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ MIME types

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **–¢–æ—á–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:** >95%
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:** 80% —Ñ–∞–π–ª–æ–≤
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases:** –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ML –º–æ–¥–µ–ª—è–º–∏: –º–∏–≥—Ä–∞—Ü–∏—è SmolDocling ‚Üí Granite-Docling

#### –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º—ã:
- –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å Cloud.ru OpenAI API
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç–æ–∫–µ–Ω–∞–º (4096 output)
- –ù–µ–ø–æ–ª–Ω—ã–µ DocTags (—Ç–æ–ª—å–∫–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –±–µ–∑ —Ç–µ–∫—Å—Ç–∞)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ batch –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –í—ã—Å–æ–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ rate limiting

#### –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

**–î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
1. **OCR/Metadata Extraction** —á–µ—Ä–µ–∑ Granite
2. **Document Structure** —á–µ—Ä–µ–∑ Docling SDK

**–§–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON —Ñ–æ—Ä–º–∞—Ç:**
```python
messages = [
    {"role": "user", "content": [
        {"type": "text", "text": "Extract metadata in JSON format"},
        {"type": "image_url", "image_url": {"url": f"data:image/jpeg;base64,{base64_img}"}}
    ]}
]
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
- DPI: 50-100 –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ –∫–∞—á–µ—Å—Ç–≤–∞/—Ä–∞–∑–º–µ—Ä–∞
- Thumbnail: 200x200px –º–∞–∫—Å–∏–º—É–º
- JPEG compression: quality=50

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:** 100% —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- **–ü–æ–ª–Ω—ã–µ DocTags:** –° —Ç–µ–∫—Å—Ç–æ–º –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- **Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞:** 10-20x –±—ã—Å—Ç—Ä–µ–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π
- **–°—Ç–æ–∏–º–æ—Å—Ç—å:** $0.002-0.003/—Å—Ç—Ä–∞–Ω–∏—Ü–∞ vs $0.01-0.05

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ PDF —Å–∫–∞–Ω–æ–≤: OCR pipeline, fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã

#### –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º—ã:
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ OCR –¥–ª—è —Å–∫–∞–Ω–æ–≤
- –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ —Ñ–æ—Ä–º—É–ª–∞–º–∏

#### –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Docling OCR:**
```python
from docling.pipeline.vlm_pipeline import VlmPipeline

converter = DocumentConverter(
    format_options={
        InputFormat.PDF: PdfFormatOption(
            pipeline_cls=VlmPipeline,
            do_ocr=True,
            do_table_structure=True
        )
    }
)
```

**Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã:**
1. **Docling OCR** (–æ—Å–Ω–æ–≤–Ω–æ–π)
2. **pdfplumber** –¥–ª—è text-based PDF
3. **pytesseract** –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
4. **Layout analysis** –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è PDF:**
```python
def classify_pdf(pdf_path: Path) -> bool:
    """True –µ—Å–ª–∏ PDF —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç, False –µ—Å–ª–∏ —Å–∫–∞–Ω"""
    with open(pdf_path, "rb") as f:
        pdf = pypdf.PdfReader(f)
        for page in pdf.pages[:3]:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤—ã–µ 3 —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            if page.extract_text().strip():
                return True
    return False
```

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å OCR:** >90% –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∫–∞–Ω–æ–≤
- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:** –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **Fallback –ø–æ–∫—Ä—ã—Ç–∏–µ:** 100% —Å–ª—É—á–∞–µ–≤

### 4. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: split-tunnel VPN, –∞—Ç–æ–º–∞—Ä–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º—ã:
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å zakupki.gov.ru
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å VPN –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º
- –ü–æ—Ç–µ—Ä—è –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –ø—Ä–∏ —Å–±–æ—è—Ö

#### –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

**Split-tunnel VPN –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```bash
# OpenVPN —Å route-nopull
route 95.167.245.92 255.255.255.255 vpn_gateway
```

**–ê—Ç–æ–º–∞—Ä–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ MongoDB:**
```javascript
// –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
db.protocols.updateOne(
    { _id: protocolId, status: "new" },
    { $set: { status: "reserved", worker_id: workerId, reserved_at: new Date() } }
)
```

**–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ:**
- ThreadPoolExecutor —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º concurrency
- Rate limiting (1 –∑–∞–ø—Ä–æ—Å/—Å–µ–∫—É–Ω–¥—É)
- Retry –º–µ—Ö–∞–Ω–∏–∑–º —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- Timeout: 60 —Å–µ–∫—É–Ω–¥ –Ω–∞ —Ñ–∞–π–ª
- Retry: 3 –ø–æ–ø—ã—Ç–∫–∏ —Å backoff
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–±–æ–µ–≤

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **–°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ:** 99% —É—Å–ø–µ—Ö
- **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º:** 30 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
- **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
- **–ë–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:** –ê—Ç–æ–º–∞—Ä–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤: –∑–∞—â–∏—Ç–∞ –æ—Ç zip bomb, —Ñ–µ–π–∫–æ–≤—ã–µ DOC

#### –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º—ã:
- Zip bomb –∞—Ç–∞–∫–∏ (–±–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –ø—Ä–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ)
- –§–µ–π–∫–æ–≤—ã–µ DOC —Ñ–∞–π–ª—ã (–∞—Ä—Ö–∏–≤—ã —Å –¥—Ä—É–≥–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º)
- –°–º–µ—à–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã —Ñ–∞–π–ª–æ–≤ –≤ –∞—Ä—Ö–∏–≤–∞—Ö
- Path traversal —É—è–∑–≤–∏–º–æ—Å—Ç–∏

#### –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

**–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞:**
```python
MAX_UNPACK_SIZE_MB = 500
MAX_FILES_IN_ARCHIVE = 1000

def safe_extract(archive_path: Path, extract_to: Path):
    total_size = 0
    file_count = 0
    
    with zipfile.ZipFile(archive_path) as zf:
        for info in zf.filelist:
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
            total_size += info.file_size
            if total_size > MAX_UNPACK_SIZE_MB * 1024 * 1024:
                raise ValueError("Archive too large")
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤
            file_count += 1
            if file_count > MAX_FILES_IN_ARCHIVE:
                raise ValueError("Too many files")
                
            # –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏
            safe_path = Path(info.filename).resolve()
            if ".." in str(safe_path):
                raise ValueError("Path traversal detected")
```

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–µ–π–∫–æ–≤—ã—Ö DOC:**
```python
def detect_fake_doc(file_path: Path) -> bool:
    """True –µ—Å–ª–∏ DOC —Ñ–∞–π–ª –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –∞—Ä—Ö–∏–≤"""
    with open(file_path, "rb") as f:
        header = f.read(4)
        return header.startswith(b"PK\x03\x04")  # ZIP signature
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ mixed units:**
- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö unit'–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–≤—è–∑–µ–π —á–µ—Ä–µ–∑ manifest.json
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** 100% –∑–∞—â–∏—Ç–∞ –æ—Ç zip bomb
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–µ–π–∫–æ–≤—ã—Ö DOC:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
- **–°–º–µ—à–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏–≤—ã:** –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞

---

## –ò–°–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–°–ö–ò–ï –†–ê–ë–û–¢–´

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å ML –º–æ–¥–µ–ª—è–º–∏

#### SmolDocling —á–µ—Ä–µ–∑ Cloud.ru API

**–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è:**
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PDF –≤ thumbnail –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ OpenAI-compatible API
- –ê–Ω–∞–ª–∏–∑ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö DocTags

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚ùå –ù–µ–ø–æ–ª–Ω—ã–µ DocTags (—Ç–æ–ª—å–∫–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
- ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç–æ–∫–µ–Ω–∞–º (4096 output)
- ‚ùå –ù–µ—Ç batch –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚ùå –í—ã—Å–æ–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å ($0.01-0.05/—Å—Ç—Ä–∞–Ω–∏—Ü–∞)

**–í—ã–≤–æ–¥—ã:**
- Cloud.ru API –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ Docling
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

#### Granite-Docling Remote API

**–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è:**
- –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Granite –º–æ–¥–µ–ª–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ –ü–æ–ª–Ω—ã–µ DocTags —Å —Ç–µ–∫—Å—Ç–æ–º –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úÖ Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ VLLM
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å ($0.002-0.003/—Å—Ç—Ä–∞–Ω–∏—Ü–∞)

**–í—ã–≤–æ–¥—ã:**
- Granite –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∑–∞–¥–∞—á OCR
- –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ

#### –õ–æ–∫–∞–ª—å–Ω—ã–π Docling

**–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è:**
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ Cloud.ru vs –ª–æ–∫–∞–ª—å–Ω—ã–π Docling
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
Cloud.ru API vs –õ–æ–∫–∞–ª—å–Ω—ã–π Docling:

–ü–æ–ª–Ω—ã–µ DocTags:      ‚ùå vs ‚úÖ
–ö–∞—á–µ—Å—Ç–≤–æ Markdown:   –ù–∏–∑–∫–æ–µ vs –û—Ç–ª–∏—á–Ω–æ–µ
–¢–∞–±–ª–∏—Ü—ã:            ‚ùå vs ‚úÖ
Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞:    ‚ùå vs ‚úÖ
–í—Ä–µ–º—è (100 —Å—Ç—Ä):    10-13 –º–∏–Ω vs 1-2 –º–∏–Ω
–°—Ç–æ–∏–º–æ—Å—Ç—å:          $10-50 vs $2-3
```

**–í—ã–≤–æ–¥—ã:**
- –õ–æ–∫–∞–ª—å–Ω—ã–π Docling –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç Cloud.ru
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

#### Qwen3 Vision OCR

**–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è:**
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ OCR
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–∞—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Docling OCR

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ OCR
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏
- ‚ö†Ô∏è –ú–µ–Ω–µ–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚ö†Ô∏è –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π layout analysis

**–í—ã–≤–æ–¥—ã:**
- –•–æ—Ä–æ—à–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö OCR –∑–∞–¥–∞—á
- –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ª—É—á—à–µ Docling

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF

#### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PDF –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- DPI: 50, 72, 100, 150, 300
- –†–∞–∑–º–µ—Ä thumbnail: 100x100, 144x200, 200x200, 512x512
- –§–æ—Ä–º–∞—Ç: JPEG, PNG
- –ö–∞—á–µ—Å—Ç–≤–æ —Å–∂–∞—Ç–∏—è: 50%, 75%, 90%

**–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
```python
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
DPI = 50
MAX_SIZE = (200, 200)
FORMAT = 'JPEG'
QUALITY = 50
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- **DPI 50:** –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è OCR, –∫–æ–º–ø–∞–∫—Ç–Ω–æ
- **200x200px:** –ë–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞
- **JPEG 50%:** –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–∂–∞—Ç–∏–µ

#### Thumbnail –ø–æ–¥—Ö–æ–¥ vs –ø–æ–ª–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**
```
Thumbnail (200x200): ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –∫–æ–º–ø–∞–∫—Ç–Ω–æ
–ü–æ–ª–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ‚ùå –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤, —Å–±–æ–∏ —Å–µ—Ä–≤–µ—Ä–∞
```

**–í—ã–≤–æ–¥—ã:**
- Thumbnail –ø–æ–¥—Ö–æ–¥ –æ–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è API
- –ü–æ–ª–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–±—ã—Ç–æ—á–Ω—ã

#### Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞ vs –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è:** 6-8 —Å–µ–∫/—Å—Ç—Ä–∞–Ω–∏—Ü–∞ (Cloud.ru)
- **Batch:** 0.5 —Å–µ–∫/—Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–π VLLM)
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ:** 10-20x

**–í—ã–≤–æ–¥—ã:**
- Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

#### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ SHA256

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
def get_file_hash(file_path: Path) -> str:
    sha256 = hashlib.sha256()
    with open(file_path, "rb") as f:
        for chunk in iter(lambda: f.read(4096), b""):
            sha256.update(chunk)
    return sha256.hexdigest()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- **–≠–∫–æ–Ω–æ–º–∏—è:** –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ vs –º–æ–Ω–æ–ª–∏—Ç

**–ê–Ω–∞–ª–∏–∑:**
```
–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã: ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å, –∏–∑–æ–ª—è—Ü–∏—è, –≥–∏–±–∫–æ—Å—Ç—å
–ú–æ–Ω–æ–ª–∏—Ç:      ‚ö†Ô∏è –°–ª–æ–∂–Ω–µ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

**–í—ã–±–æ—Ä:** –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- Router, Docling, Downloader –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- Docker Compose –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
- API –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ HTTP

#### MongoDB –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö vs —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**
```
MongoDB:        ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –∏–Ω–¥–µ–∫—Å—ã, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
–§–∞–π–ª–æ–≤–∞—è:      ‚ö†Ô∏è –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ACID, –ª–∏–º–∏—Ç—ã —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
```

**–í—ã–±–æ—Ä:** MongoDB –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ manifest'–æ–≤
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ —Å—Ç–∞—Ç—É—Å—É –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤

#### Docker Compose –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ scale
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- ‚ö†Ô∏è –°–ª–æ–∂–Ω–µ–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ production

#### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ç—Ä–∞—Ç–µ–≥–∏–∏:**
1. **Docker Compose scale:**
   ```bash
   docker-compose up -d --scale router=3 --scale docling=2
   ```

2. **Load balancer** –¥–ª—è router —Å–µ—Ä–≤–∏—Å–æ–≤

3. **Redis queue** –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

4. **External GPU** —Å–µ—Ä–≤–µ—Ä—ã –¥–ª—è LLM

---

## –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –†–ê–ó–†–ê–ë–û–¢–ö–ò

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ (3 –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏—Å—Ç–∏–Ω—ã)
- ‚úÖ **–¢–æ—á–Ω–æ—Å—Ç—å:** >95% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
- ‚úÖ **Coverage:** –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (PDF, DOCX, –∞—Ä—Ö–∏–≤—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- ‚úÖ **Edge cases:** –§–µ–π–∫–æ–≤—ã–µ DOC, OLE2 —Ñ–æ—Ä–º–∞—Ç—ã
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** <1 —Å–µ–∫ –Ω–∞ —Ñ–∞–π–ª

#### –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ VPN
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** 99% —É—Å–ø–µ—à–Ω—ã—Ö —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º:** 30 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
- ‚úÖ **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** Retry —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- ‚úÖ **–ë–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:** –ê—Ç–æ–º–∞—Ä–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ MongoDB

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ PDF —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º —Å–ª–æ–µ–º
- ‚úÖ **Text extraction:** –ü–æ–ª–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
- ‚úÖ **Layout analysis:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ **Table extraction:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–§–æ—Ä–º–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∞:** JSON, Markdown, HTML

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ DOCX —Ñ–∞–π–ª–æ–≤
- ‚úÖ **Text extraction:** –ü–æ–ª–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
- ‚úÖ **Structure preservation:** –ó–∞–≥–æ–ª–æ–≤–∫–∏, –ø–∞—Ä–∞–≥—Ä–∞—Ñ—ã, —Å–ø–∏—Å–∫–∏
- ‚úÖ **Table extraction:** –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- ‚úÖ **Metadata:** –°–≤–æ–π—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞

#### –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç zip bomb
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –õ–∏–º–∏—Ç—ã —Ä–∞–∑–º–µ—Ä–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤:** ZIP, RAR (–≤–∫–ª—é—á–∞—è RAR5)
- ‚úÖ **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è:** –ó–∞—â–∏—Ç–∞ –æ—Ç path traversal
- ‚úÖ **–§–µ–π–∫–æ–≤—ã–µ DOC:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ

#### CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤:** –ß–µ—Ä–µ–∑ API –∏ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏, –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** Cron-based scheduler
- ‚úÖ **API endpoints:** RESTful –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ Docling OCR
- üîÑ **–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (fallback –∫ pdfplumber)
- üéØ **–¶–µ–ª—å:** –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Docling OCR pipeline
- üìã **–ó–∞–¥–∞—á–∏:**
  - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docling –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VLM pipeline
  - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ PDF —Å–∫–∞–Ω–∞—Ö
  - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ mixed units
- üîÑ **–°—Ç–∞—Ç—É—Å:** –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- üéØ **–¶–µ–ª—å:** –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ –∞—Ä—Ö–∏–≤–∞—Ö
- üìã **–ó–∞–¥–∞—á–∏:**
  - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
  - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ unit'–æ–≤
  - Merge —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

#### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ unit'–æ–≤
- üîÑ **–°—Ç–∞—Ç—É—Å:** –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- üéØ **–¶–µ–ª—å:** –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
- üìã **–ó–∞–¥–∞—á–∏:**
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Redis –¥–ª—è –æ—á–µ—Ä–µ–¥–∏
  - Worker pool –¥–ª—è Docling
  - Load balancing –º–µ–∂–¥—É –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏

#### –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
- üîÑ **–°—Ç–∞—Ç—É—Å:** –ë–∞–∑–æ–≤–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
- üéØ **–¶–µ–ª—å:** –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- üìã **–ó–∞–¥–∞—á–∏:**
  - NER (Named Entity Recognition) –¥–ª—è –∏–º–µ–Ω
  - –°—É–º–º—ã –∏ –¥–∞—Ç—ã —á–µ—Ä–µ–∑ regex patterns
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - API –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ Prometheus/Grafana
- üîÑ **–°—Ç–∞—Ç—É—Å:** –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ MongoDB
- üéØ **–¶–µ–ª—å:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ production
- üìã **–ó–∞–¥–∞—á–∏:**
  - –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –≤ Prometheus
  - Grafana dashboards
  - –ê–ª–µ—Ä—Ç—ã –Ω–∞ —Å–±–æ–∏
  - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

#### OCR –¥–ª—è PDF —Å–∫–∞–Ω–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- **–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback (pdfplumber + pytesseract)
- **–í–ª–∏—è–Ω–∏–µ:** –°–Ω–∏–∂–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ OCR –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–†–µ—à–µ–Ω–∏–µ:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ Docling OCR pipeline
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π

#### Mixed units –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- **–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª—ã –≤ –∞—Ä—Ö–∏–≤–∞—Ö –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏
- **–í–ª–∏—è–Ω–∏–µ:** –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –∞—Ä—Ö–∏–≤–æ–≤
- **–†–µ—à–µ–Ω–∏–µ:** –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ unit'–µ
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π

#### –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ, –±–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
- **–í–ª–∏—è–Ω–∏–µ:** –†—É—á–Ω–∞—è –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–†–µ—à–µ–Ω–∏–µ:** ML-–º–æ–¥–µ–ª–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ unit'–æ–≤
- **–í–ª–∏—è–Ω–∏–µ:** –î–ª–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—ã—Å—è—á —Ñ–∞–π–ª–æ–≤
- **–†–µ—à–µ–Ω–∏–µ:** –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –æ—á–µ—Ä–µ–¥—è–º–∏
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ **Unit tests:** –î–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ **Integration tests:** –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞
- üîÑ **Load tests:** –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚ùå **E2E tests:** –¢—Ä–µ–±—É—é—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏

---

## –ú–ï–¢–†–ò–ö–ò –ò –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ —Ç–∏–ø–∞–º —Ñ–∞–π–ª–æ–≤

```
PDF —Å —Ç–µ–∫—Å—Ç–æ–º (pdf_text):    ~0.5-2 —Å–µ–∫
PDF —Å–∫–∞–Ω—ã (pdf_scan):        ~1-5 —Å–µ–∫ (—Å OCR)
DOCX —Ñ–∞–π–ª—ã:                  ~0.3-1 —Å–µ–∫
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (OCR):           ~2-8 —Å–µ–∫
–ê—Ä—Ö–∏–≤—ã (—Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞):         ~0.1-0.5 —Å–µ–∫ + –≤—Ä–µ–º—è –Ω–∞ —Ñ–∞–π–ª—ã
```

### –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ü–æ —ç—Ç–∞–ø–∞–º:**
- **Preprocessing:** 100% (Router)
- **Docling:** 100% (—Å fallback)
- **–û–±—â–∞—è:** 100%

**–ü–æ —Ç–∏–ø–∞–º —Ñ–∞–π–ª–æ–≤:**
- **PDF text:** 98%
- **PDF scan:** 95% (—Å —É–ª—É—á—à–µ–Ω–Ω—ã–º OCR: 99%)
- **DOCX:** 100%
- **Images:** 97%
- **Archives:** 100%

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

**CPU:** 2-4 vCPU –Ω–∞ DigitalOcean droplet
**RAM:** 8GB (–ø–∏–∫–∏ –¥–æ 6GB –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ)
**Disk:** 50-100GB –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
**Network:** 100Mbps –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

### –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **1 —Å–µ—Ä–≤–µ—Ä:** 100-200 —Ñ–∞–π–ª–æ–≤/—á–∞—Å
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:** –õ–∏–Ω–µ–π–Ω–æ–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- **Memory:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
- **CPU:** OCR –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **I/O:** –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –∏ –∞—Ä—Ö–∏–≤—ã

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- **Batch processing:** –î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è overhead
- **Caching:** SHA256 —Ö—ç—à–∏ –¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- **Streaming:** –î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

---

## –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-3 –º–µ—Å—è—Ü–∞)

#### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ Docling OCR
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–º–µ–Ω–∞ fallback –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π Docling OCR pipeline
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** +20% —Ç–æ—á–Ω–æ—Å—Ç—å OCR, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∞–±–ª–∏—Ü
**–†–µ—Å—É—Ä—Å—ã:** 2-3 –Ω–µ–¥–µ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

#### 2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ unit'–æ–≤
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏ (Redis) –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** 5-10x –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
**–†–µ—Å—É—Ä—Å—ã:** 1-2 –Ω–µ–¥–µ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

#### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** Prometheus + Grafana –¥–ª—è –º–µ—Ç—Ä–∏–∫ –∏ –∞–ª–µ—Ä—Ç–æ–≤
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ production
**–†–µ—Å—É—Ä—Å—ã:** 1 –Ω–µ–¥–µ–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (3-6 –º–µ—Å—è—Ü–µ–≤)

#### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** NER –º–æ–¥–µ–ª–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π, —Å—É–º–º, –¥–∞—Ç
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏
**–†–µ—Å—É—Ä—Å—ã:** 2-3 –º–µ—Å—è—Ü–∞ ML —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

#### 2. API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** REST API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
**–†–µ—Å—É—Ä—Å—ã:** 1 –º–µ—Å—è—Ü —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

#### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ PostgreSQL –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤
**–†–µ—Å—É—Ä—Å—ã:** 2-3 –Ω–µ–¥–µ–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è (6-12 –º–µ—Å—è—Ü–µ–≤)

#### 1. –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
**–û–ø–∏—Å–∞–Ω–∏–µ:** OCR –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤ (–∫–∏—Ç–∞–π—Å–∫–∏–π, –∞—Ä–∞–±—Å–∫–∏–π)
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

#### 2. GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è ML –∑–∞–¥–∞—á
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** 10-50x –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å OCR

#### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** Fine-tuning –º–æ–¥–µ–ª–µ–π –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫—É–ø–æ–∫
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –ü–æ–≤—ã—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è

#### 4. –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è
**–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤
**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –õ—É—á—à–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

---

## –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–ü—Ä–æ–µ–∫—Ç Winners223 –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –∑—Ä–µ–ª–æ—Å—Ç–∏ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º–∞ –≤ —Ä–µ—à–µ–Ω–∏–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –∑–∞–¥–∞—á –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. 

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ù–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å ML –º–æ–¥–µ–ª—è–º–∏
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–¢–µ–∫—É—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production:** –í—ã—Å–æ–∫–∞—è (90%+)
**–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è:** OCR –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

---

*–û—Ç—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ Winners223*
*–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: –î–µ–∫–∞–±—Ä—å 2025*
*–û–±—ä–µ–º: ~80 —Å—Ç—Ä–∞–Ω–∏—Ü —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞*
