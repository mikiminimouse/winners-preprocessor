# DocPrep Pipeline Test Report
**Date:** 2026-01-16
**Dataset:** 6125 UNIT from `/Data/2025-03-04/Input`

---

## Executive Summary

| Metric | Value | Percentage |
|--------|-------|------------|
| **Total Input UNIT** | 6,125 | 100% |
| **Ready2Docling** | 5,084 | 83.0% |
| **Exceptions** | 1,040 | 17.0% |
| **In Processing** | 1 | 0.016% |

**Overall Success Rate: 83.0%**

---

## Phase 1: Classification Results (Cycle 1)

| Category | Count | Description |
|----------|-------|-------------|
| **Direct** | 3,983 | Ready immediately (pdf, docx, html, xlsx) |
| **Convert** | 841 | Need conversion (doc, rtf, xls) |
| **Extract** | 455 | Archives (zip, rar, 7z) |
| **Normalize** | 59 | Need filename normalization |
| **Empty** | 785 | Empty directories |
| **Ambiguous** | 2 | Mixed/unclear file types |

---

## Phase 2: Processing Results

### Conversion (doc/rtf/xls â†’ docx/xlsx)
| Status | Count | Rate |
|--------|-------|------|
| Success | 588 | 69.9% |
| Failed (ErConvert) | 253 | 30.1% |
| **Total** | 841 | 100% |

**Note:** ErConvert failures are typically due to corrupted or password-protected documents.

### Extraction (zip/rar/7z)
| Status | Count | Rate |
|--------|-------|------|
| Success | 454 | 99.8% |
| Remaining (Mixed) | 1 | 0.2% |
| **Total** | 455 | 100% |

### Normalization
| Status | Count | Rate |
|--------|-------|------|
| Success | 59 | 100% |
| **Total** | 59 | 100% |

---

## Final Distribution

### Ready2Docling: 5,084 UNIT
| Source | Count |
|--------|-------|
| Direct (pdf, docx, html, xlsx, Mixed) | 3,983 |
| Converted | 588 |
| Extracted | 454 |
| Normalized | 59 |

### Exceptions: 1,040 UNIT
| Type | Count | Description |
|------|-------|-------------|
| Empty | 785 | No processable files |
| ErConvert | 253 | LibreOffice conversion failed |
| Ambiguous | 2 | Unclear classification |

### Processing (Incomplete): 1 UNIT
- `UNIT_f16ed00f9be44c6c` - Mixed type (PDF + ZIP), requires manual handling

---

## Verification

```
Input:        0
Ready2Docling: 5,084
Exceptions:    1,040
Processing:    1
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total:         6,125 âœ“
```

---

## Issues Found

### 1. Non-critical Warning
- **Issue:** "cannot access local variable 'get_data_paths'" in classifier
- **Impact:** Cosmetic warning, does not affect processing
- **Status:** Low priority fix

### 2. Conversion Failures (253 UNIT)
- **Cause:** LibreOffice cannot convert certain .doc files
- **Common reasons:** Corrupted files, password protection, legacy formats
- **Recommendation:** Manual inspection or alternative converters

### 3. Mixed Type Handling (1 UNIT)
- **Issue:** UNIT with PDF + ZIP not fully processed
- **Recommendation:** Enhance Mixed type handler to process PDF immediately and extract ZIP separately

---

## Refactoring Checklist Status

| Task | Status |
|------|--------|
| Typos ErExtact/ErNormalaze | âœ… Fixed |
| MAX_CYCLES constant | âœ… Fixed (value: 3) |
| TIMEOUT constants in converter | âœ… Fixed |
| bare except â†’ specific | âœ… Fixed |
| .gitignore created | âœ… Done |
| Garbage files removed | âœ… Done |
| test_cli.py removed | âœ… Done |
| fsync() in audit.py | âœ… Already present |
| Giant classifier method | ðŸ”„ Needs analysis |
| Duplication in exceptions.py | ðŸ”„ Needs analysis |
| 11 failing tests (isolation) | ðŸ”„ Needs fixing |

---

## Recommendations

1. **Investigate ErConvert failures** - Sample and analyze failed .doc files
2. **Improve Mixed type handling** - Process each file type separately
3. **Fix get_data_paths warning** - Update variable scope in classifier
4. **Add retry logic** - For transient conversion failures
5. **Run Cycle 2/3** - If extracted archives contain nested content

---

## Performance Notes

- Classifier: ~6125 UNIT processed in ~4 minutes
- Convert: ~841 UNIT processed in ~12 minutes (with LibreOffice)
- Extract: ~455 UNIT processed in ~2 minutes
- Normalize: ~59 UNIT processed in ~30 seconds

**Total Pipeline Time:** ~20 minutes for 6125 UNIT

---

*Report generated by DocPrep Pipeline Test*
