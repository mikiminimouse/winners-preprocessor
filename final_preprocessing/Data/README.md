# Структура директорий Data

Эта директория содержит все данные для preprocessing pipeline согласно PRD.

## Структура

```
Data/
├── Input/                    # Входные данные (UNIT_XXX)
│   └── YYYY-MM-DD/           # Данные по датам
│       └── UNIT_XXX/
│           ├── file1.pdf
│           └── file2.docx
│
├── Processing/               # Промежуточная обработка
│   └── YYYY-MM-DD/
│       ├── Pending_1/        # Первый цикл обработки
│       │   ├── convert/      # Требуют конвертации
│       │   │   ├── doc/
│       │   │   ├── xls/
│       │   │   └── ...
│       │   ├── archives/    # Требуют разархивации
│       │   │   ├── zip/
│       │   │   ├── rar/
│       │   │   └── 7z/
│       │   ├── direct/      # Готовы к обработке
│       │   │   ├── docx/
│       │   │   ├── pdf/
│       │   │   └── ...
│       │   └── normalize/   # Требуют нормализации
│       │       ├── docx/
│       │       ├── pdf/
│       │       └── ...
│       ├── Pending_2/        # Второй цикл
│       └── Pending_3/        # Третий цикл
│
├── Exceptions/               # Исключения (отдельная директория, аналогично Merge)
│   └── YYYY-MM-DD/
│       ├── Exceptions_1/      # Исключения цикла 1
│       │   ├── special/
│       │   ├── mixed/
│       │   └── unknown/
│       ├── Exceptions_2/
│       └── Exceptions_3/
│
├── Merge/                    # Готовые к объединению
│   └── YYYY-MM-DD/
│       ├── Merge_1/
│       │   └── direct/      # Только direct из цикла 1
│       │       ├── docx/
│       │       ├── pdf/
│       │       └── ...
│       ├── Merge_2/
│       │   ├── extracted/   # Извлеченные из архивов
│       │   ├── converted/    # Конвертированные
│       │   └── normalized/   # Нормализованные
│       └── Merge_3/
│           └── [аналогично Merge_2]
│
└── Ready2Docling/            # Финальный результат
    └── YYYY-MM-DD/
        ├── docx/
        ├── pdf/
        │   ├── scan/        # PDF для OCR
        │   └── text/        # PDF с текстом
        ├── jpeg/
        └── ...
```

## Инициализация структуры

Для создания структуры для конкретной даты:

```bash
# Через CLI
docprep utils init-date 2025-03-18

# Или через скрипт
python scripts/init_data_structure.py --date 2025-03-18
```

## Принципы организации

1. **Сортировка по расширениям**: Все UNIT_XXX размещаются в поддиректориях по расширению файлов
2. **Организация по датам**: Все данные организованы по датам (YYYY-MM-DD)
3. **3 цикла обработки**: Максимум 3 итерации классификации и обработки
4. **State Machine**: Каждый UNIT проходит через детерминированные состояния

## Важные замечания

- UNIT_XXX никогда не дробится между директориями
- Все изменения отслеживаются в `manifest.json` и `audit.log.jsonl`
- Структура соответствует PRD раздел 11

