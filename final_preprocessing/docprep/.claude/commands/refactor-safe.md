---
name: refactor-safe
description: ะะตะทะพะฟะฐัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต ัะฐะทั ัะตัะฐะบัะพัะธะฝะณะฐ ั TDD ะธ HITL
---

# ะะตะทะพะฟะฐัะฝัะน ัะตัะฐะบัะพัะธะฝะณ โ ะคะฐะทะฐ $ARGUMENTS

## ะัะธะฝัะธะฟั ัะฐะฑะพัั

**ะะะะะ:** ะญัะพั ัะตัะฐะบัะพัะธะฝะณ ะดะพะปะถะตะฝ ะฑััั ะผะฐะบัะธะผะฐะปัะฝะพ ะฑะตะทะพะฟะฐัะฝัะผ. ะกะปะตะดัะน ะฟัะธะฝัะธะฟะฐะผ:
- TDD: ะกะฝะฐัะฐะปะฐ ัะตััั โ ะฟะพัะพะผ ะบะพะด
- HITL: ะกะฟัะฐัะธะฒะฐะน ะฟัะธ ัะพะผะฝะตะฝะธัั
- ะะฝะบัะตะผะตะฝัะฐะปัะฝะพ: ะะฐะปะตะฝัะบะธะต ะธะทะผะตะฝะตะฝะธั โ ะฟัะพะฒะตัะบะฐ โ ัะปะตะดัััะตะต ะธะทะผะตะฝะตะฝะธะต

## ะัะพัะตะดััะฐ ะดะปั ะคะฐะทั $ARGUMENTS

### 1. ะะพะดะณะพัะพะฒะบะฐ

ะกะฝะฐัะฐะปะฐ ัะฑะตะดะธัั ััะพ ัะตะบััะตะต ัะพััะพัะฝะธะต ััะฐะฑะธะปัะฝะพ:
```bash
# ะัะพะฒะตัั ััะพ ัะตััั ะฟัะพัะพะดัั ะะ ะธะทะผะตะฝะตะฝะธะน
pytest docprep/tests/ -v --tb=short
```

ะัะปะธ ัะตััั ะฝะต ะฟัะพัะพะดัั โ ะกะขะะ! ะกะพะพะฑัะธ ะพะฑ ััะพะผ ัะตัะตะท HITL.

### 2. ะงัะตะฝะธะต ะฟะปะฐะฝะฐ

ะัะพัะธัะฐะน ะดะตัะฐะปะธ ัะฐะทั $ARGUMENTS ะธะท ะฟะปะฐะฝะฐ:
```bash
cat .claude/DOCPREP_REFACTORING_PLAN.md | grep -A 100 "ะคะะะ $ARGUMENTS"
```

### 3. TDD Workflow

ะะปั ะะะะะะะ ะธะทะผะตะฝะตะฝะธั:

**ะจะฐะณ A โ ะะฐะฟะธัะธ ัะตัั:**
```
๐งช ะกะะะะะะะ ะขะะกะขะ
ะคะฐะนะป: tests/test_<ะผะพะดัะปั>.py
ะขะตัั: test_<ััะพ_ะฟัะพะฒะตััะตะผ>
ะะถะธะดะฐะตะผะพะต ะฟะพะฒะตะดะตะฝะธะต: <ะพะฟะธัะฐะฝะธะต>
```

**ะจะฐะณ B โ ะัะพะฒะตัั ััะพ ัะตัั ะฟะฐะดะฐะตั (Red):**
```bash
pytest docprep/tests/test_<ะผะพะดัะปั>.py::<test_name> -v
# ะะพะปะถะตะฝ ะฃะะะกะขะฌ โ ััะพ ะฝะพัะผะฐะปัะฝะพ!
```

**ะจะฐะณ C โ ะะตะฐะปะธะทัะน ะธะทะผะตะฝะตะฝะธะต:**
```
๐ ะะะะะะะะะ
ะคะฐะนะป: <ะฟััั>
ะงัะพ ะผะตะฝัะตะผ: <ะพะฟะธัะฐะฝะธะต>
```

**ะจะฐะณ D โ ะัะพะฒะตัั ััะพ ัะตัั ะฟัะพัะพะดะธั (Green):**
```bash
pytest docprep/tests/test_<ะผะพะดัะปั>.py::<test_name> -v
# ะขะตะฟะตัั ะดะพะปะถะตะฝ ะะะะะขะ
```

**ะจะฐะณ E โ ะัะพะฒะตัั ััะพ ะฝะธัะตะณะพ ะฝะต ัะปะพะผะฐะปะพัั:**
```bash
pytest docprep/tests/ -v --tb=short
```

### 4. HITL Checkpoints

ะะฐะฟัะฐัะธะฒะฐะน ะฟะพะดัะฒะตัะถะดะตะฝะธะต ัะตัะตะท HITL ะตัะปะธ:
- ะฃะดะฐะปัะตัั ัะฐะนะป ะธะปะธ ััะฝะบัะธั
- ะะตะฝัะตัั ัะธะณะฝะฐัััั ะฟัะฑะปะธัะฝะพะณะพ ะผะตัะพะดะฐ
- ะะต ัะฒะตัะตะฝ ะฒ ะฟัะฐะฒะธะปัะฝะพััะธ ะธะทะผะตะฝะตะฝะธั
- ะขะตััั ะฟะฐะดะฐัั ะฟะพัะปะต ะธะทะผะตะฝะตะฝะธั

ะคะพัะผะฐั:
```
๐ HITL CHECKPOINT โ ะคะฐะทะฐ $ARGUMENTS
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ะะตะนััะฒะธะต: [ััะพ ัะพัั ัะดะตะปะฐัั]
ะัะธัะธะฝะฐ: [ะทะฐัะตะผ]
ะะธัะบ: [ััะพ ะผะพะถะตั ัะปะพะผะฐัััั]
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ะัะพะดะพะปะถะธัั? (ะดะฐ/ะฝะตั/ะพะฑััะดะธัั)
```

### 5. ะะฐะฒะตััะตะฝะธะต ัะฐะทั

ะะพัะปะต ะฒัะตั ะธะทะผะตะฝะตะฝะธะน:

```bash
# ะคะธะฝะฐะปัะฝะฐั ะฟัะพะฒะตัะบะฐ
pytest docprep/tests/ -v

# ะัะพะฒะตัะบะฐ ัะธะฝัะฐะบัะธัะฐ ะฒัะตั ัะฐะนะปะพะฒ
find docprep -name "*.py" -exec python -m py_compile {} \;

# ะัะพะฒะตัะบะฐ ััะพ ะพะฟะตัะฐัะบะธ ะธัะฟัะฐะฒะปะตะฝั (ะดะปั ะคะฐะทั 1)
grep -rn "ErExtact\|ErNormalaze" docprep/
# ะะพะปะถะฝะพ ะฑััั ะฟัััะพ!
```

### 6. ะัััั ะพ ะทะฐะฒะตััะตะฝะธะธ

```
โ ะคะะะ $ARGUMENTS ะะะะะะจะะะ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ะะทะผะตะฝัะฝะฝัะต ัะฐะนะปั:
- [ัะฟะธัะพะบ ัะฐะนะปะพะฒ]

ะะพะฒัะต ัะตััั:
- [ัะฟะธัะพะบ ัะตััะพะฒ]

ะะตะทัะปััะฐัั ัะตััะพะฒ: X passed, Y failed

ะกะปะตะดัััะฐั ัะฐะทะฐ: [ะฝะพะผะตั]
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ะะพัะพะฒ ะฟัะพะดะพะปะถะธัั? (ะดะฐ/ะฝะตั)
```
