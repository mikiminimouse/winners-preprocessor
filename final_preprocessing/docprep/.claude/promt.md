Помоги мне написать качественный системный промт для Claude code.
Мы работем над выяалением проблем и  рефакторингом компанента  @/root/winners_preprocessor/final_preprocessing/docprep .  В предыдущих сессиях мы протестировали и отладили работу субкомпанетов системы первого цикла Cycle1 (тесты были произведены на данных из @final_preprocessing/Data влоденные потдиректории final_preprocessing/Data/2025-03-18 и  final_preprocessing/Data/2025-12-20) контекст в  , пронализируй .md и json файлы в projects/-root-winners-preprocessor-final-preprocessing-docprep/8dd378b2-63ae-4be6-aecc-38fd80c25940/tool-results, projects/-root-winners-preprocessor-final-preprocessing-docprep/8dd378b2-63ae-4be6-aecc-38fd80c25940 + plans/foamy-twirling-pebble-agent-a7ebd8c.md
plans/foamy-twirling-pebble.md
plans/giggly-watching-ocean.md и projects/-root-winners-preprocessor-final-preprocessing-docprep/8dd378b2-63ae-4be6-aecc-38fd80c25940.jsonl.
В текущей итерации наша задача отладить, протестировать и отрефакторить компоненты системы, задействованные в циклах 2+ два пайплайна Docprep.
После цикла 1  начинается циклы 2+ идентичны, по есть по сути pipilene Cycle2,  Cycle3 ладлее выполняюся итерация за итерацией по циклам до тех пор пока все units из подлиркторий   до того момента, пока   неоработаные units из поддиректориий директоии final_preprocessing/Data/2025-03-XX/Processing  не будут обработаны и распредедены в ветки final_preprocessing/Data/2025-03-XX/Merge и final_preprocessing/Data/2025-03-XX/Exceptions в соответсвующие потдиректори в зависимости от результатов преобразования в Processor Core: Convert, Extract, Normаlize и  полседуюшей проверки через Decision Engine и распределения через Decision Engine в final_preprocessing/Data/2025-03-XX/Merge/Processed_1 - тоговые к merge2 docling,  final_preprocessing/Data/2025-03-18/Exceptions/Processed_1 - units c исключениями и ошиками и в Next Cycle final_preprocessing/Data/2025-03-XX/Processing/Processing_2;  и так далее аналогично циклу 2 будет выполнена итераци Цикла3 но units на обработку с помощью Processor Core будут браться уже из final_preprocessing/Data/2025-03-XX/Processing/Processing_2 и распределяться по final_preprocessing/Data/2025-03-XX/Merge/Processed_2, final_preprocessing/Data/2025-03-18/Exceptions/Processed_2 и в Next Cycle final_preprocessing/Data/2025-03-XX/Processing/Processing_3 и так до того момента пока все units из   final_preprocessing/Data/2025-03-XX/Processing/ не будут обработаны и final_preprocessing/Data/2025-03-XX/Processing/Processing_n не будет содержать units подлежацие обрабоки в новом цикле.
В текущей итерации наша задача отладить, протестировать и отрефакторить компоненты системы, задействованные в циклах 2+ два пайплайна Docprep.
После цикла 1  начинается циклы 2+ идентичны, по есть по сути pipilene Cycle2,  Cycle3 ладлее выполняюся итерация за итерацией по циклам до тех пор пока все units из подлиркторий   до того момента, пока   неоработаные units из поддиректориий директоии final_preprocessing/Data/2025-03-XX/Processing  не будут обработаны и распредедены в ветки final_preprocessing/Data/2025-03-XX/Merge и final_preprocessing/Data/2025-03-XX/Exceptions в соответсвующие потдиректори в зависимости от результатов преобразования в Processor Core: Convert, Extract, Normаlize и  полседуюшей проверки через Decision Engine и распределения через Decision Engine в final_preprocessing/Data/2025-03-XX/Merge/Processed_1 - тоговые к merge2 docling,  final_preprocessing/Data/2025-03-18/Exceptions/Processed_1 - units c исключениями и ошиками и в Next Cycle final_preprocessing/Data/2025-03-XX/Processing/Processing_2;  и так далее аналогично циклу 2 будет выполнена итераци Цикла3 но units на обработку с помощью Processor Core будут браться уже из final_preprocessing/Data/2025-03-XX/Processing/Processing_2 и распределяться по final_preprocessing/Data/2025-03-XX/Merge/Processed_2, final_preprocessing/Data/2025-03-18/Exceptions/Processed_2 и в Next Cycle final_preprocessing/Data/2025-03-XX/Processing/Processing_3 и так до того момента пока все units из   final_preprocessing/Data/2025-03-XX/Processing/ не будут обработаны и final_preprocessing/Data/2025-03-XX/Processing/Processing_n не будет содержать units подлежацие обрабоки в новом цикле.
Особое внимание нужно уделить компанету " Processor Core" и то как в нем обрабаотываюся units:
 при Convert конвертации старых msoffice файлов в новые с помошью Libbraoffice в несеолько потоков (например .doc в .docx и  другие units с расширениями требуюшие конвертации перед подачей в pipeline Docling),  - убедись что файлы корекно конвертируюся из исходного расширения в нужный целевой формат для Docling pipeline;
при extract извлечениие/разорзовирование архивных файлов (например .rar в .zip   .7z ); при Normаlize нормализации проблем в имени и расширении файлов units ("0401-ЯР-25-2_32515474123 протокол итог. чdocx" или "Протокол аукpdf"). 
На данном этапе мы рефактоим процес cycle 2+ до шага merge2docling не затрагивая merge2docling этап, нам нужно убелиться что все до шага merge2docling отработтывает корекно без ошибоки.
Как референс проанализиуй как утроены процесы по циклам и компанетам в протатипе webui final_preprocessing/webui_docprep в компаненте final_preprocessing/webui_docprep/components/ProcessingControl.tsx по циклам и комранетам циклов до этапа merge2docling.@winners_preprocessor/final_preprocessing/docprep @.claude/plans/foamy-twirling-pebble-agent-a7ebd8c.md @.claude/plans/giggly-watching-ocean.md @.claude/plans/foamy-twirling-pebble.md 