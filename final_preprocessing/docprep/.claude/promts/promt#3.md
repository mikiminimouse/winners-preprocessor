Продолжаем рефакторигн и мелкие улучшения компанеты /root/winners_preprocessor/final_preprocessing/docprep. Проанализируй, в какой момент и почему создаются поддиректории с расширениями в различных ветках до того, как туда были перемещены Units, как, например, в /root/winners_preprocessor/final_preprocessing/Data/2025-12-20/Ready2Docling или /root/winners_preprocessor/final_preprocessing/Data/2025-12-20/Processing/Processing_3/Convert Проанализируй, в какой момент создаются пустые поддиректории с именем расширений в названии (например ppt, doc, docx, pdf и  другие ) в различных ветках, включая ветки merge, exception, processing и другие. Это не правильно, поддиректории с именем расширений должны создаваться непосредственно в тот момент, когда в них перемещается первый юнит. До этого оддиректории с именем расширений в названии (например ppt, doc, docx, pdf и  другие )  создаваться не должны.
так же проследи по какой причине Converted mixed units после конвертации смешались в /root/winners_preprocessor/final_preprocessing/Data/2025-12-20/Merge/Processed_1/Converted/ например в  потдиректрии "docx" вместо того что б остваваться в "Mixed" но уже в  /root/winners_preprocessor/final_preprocessing/Data/2025-12-20/Merge/Processed_1/Converted/ испаравь это так же.
дополнительно полностью отключи и удали из кода небходимость  передавать skip_ready2docling=True, так это дейтвие не должно управляться пораметром, ready2docling это отдельный этап и шаг который произодит по отдельному сченарию, как отдельная итерация сборки units из всех потдиреторий ветки "Merge" в финальную "Ready2Docling", толко по тригеру если на предыдущем цикле все units из диреторий ветки "Processing" были обработыны.
Примени все испоавления коректным образом, проведи тесты реальных данных из @/root/winners_preprocessor/final_preprocessing/Data/2025-12-20 отладь проблемы и предотавь подробный отчет о проделаной работе и метриках обработки Units.
для тестирования предварительно  очисти  и поудаляй все потдиркетории в   @/root/winners_preprocessor/final_preprocessing/Data/2025-12-20 кроме  "Input" и после чего проведи полерценные тесты всех циклов последовательно без dryrun и предоставь отчет о проделаной работе и метриках обработки Units.