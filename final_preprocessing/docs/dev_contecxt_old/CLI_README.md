# CLI –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

## –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
cd preprocessing
python3 run_cli.py
```

### –ó–∞–ø—É—Å–∫ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
```bash
cd preprocessing
docker-compose run --rm cli
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∏–∑ MongoDB** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∑–∞ –¥–∞—Ç—É
- **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤** - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ VPN
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ INPUT_DIR** - –ø—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞
- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞** - —Ç–µ—Å—Ç –¥–µ—Ç–µ–∫—Ü–∏–∏ MIME + signature + extension
- **–†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤** - —Ç–µ—Å—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—è ZIP/RAR/7z
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è unit'–æ–≤** - —Å–æ–∑–¥–∞–Ω–∏–µ normalized —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- **–°–æ–∑–¥–∞–Ω–∏–µ manifest'–æ–≤** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è JSON –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **Docling –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ pipeline OCR + Layout

### 3. –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ü–æ–ª–Ω—ã–π pipeline —Ç–µ—Å—Ç** - –≤—Å–µ —ç—Ç–∞–ø—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç Router API** - –ø—Ä–æ–≤–µ—Ä–∫–∞ REST endpoints

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–ú–µ—Ç—Ä–∏–∫–∏ —Å–µ—Å—Å–∏–∏** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–õ–æ–≥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏** - –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—à–∏–±–æ–∫ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–°—Ç–∞—Ç—É—Å MongoDB** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

### 5. –°–ª—É–∂–µ–±–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–û—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã** - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ pipeline
```
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-16]: 9
=== –ü–û–õ–ù–´–ô –¢–ï–°–¢ PIPELINE ===
üéØ –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–π —Å–µ—Å—Å–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: abc123-def456
...
üéâ –ü–û–õ–ù–´–ô –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù!
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Router API
```
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-16]: 10
=== –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–´–ô –¢–ï–°–¢ ROUTER API ===
‚úÖ Router API –¥–æ—Å—Ç—É–ø–µ–Ω
‚úÖ Docling API –¥–æ—Å—Ç—É–ø–µ–Ω
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ /process_now endpoint...
‚úÖ process_now –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-16]: 15  # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-16]: 4   # –¢–µ—Å—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-16]: 6   # –¢–µ—Å—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
–ó–ê–ì–†–£–ó–ö–ê ‚Üí –î–ï–¢–ï–ö–¶–ò–Ø ‚Üí –†–ê–°–ü–ê–ö–û–í–ö–ê ‚Üí –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–Ø ‚Üí MANIFEST ‚Üí DOCLING
    ‚Üì         ‚Üì         ‚Üì           ‚Üì            ‚Üì          ‚Üì
 –ü—Ä–æ—Ç–æ–∫–æ–ª—ã  –¢–∏–ø —Ñ–∞–π–ª–∞  –ê—Ä—Ö–∏–≤—ã     Unit'—ã     –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ   OCR+Layout
```

## –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ stdout
- –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ MongoDB (`processing_metrics`)
- Manifest'—ã –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ Router API `/status/{unit_id}`
- –õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤: `docker-compose logs -f cli`

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `MONGO_SERVER` | MongoDB —Ö–æ—Å—Ç:–ø–æ—Ä—Ç | `mongodb:27017` |
| `DOCLING_API` | Docling endpoint | `http://docling:8000/process` |
| `INPUT_DIR` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ | `/app/input` |

## –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏

- `Ctrl+C` - –≤—ã—Ö–æ–¥ –∏–∑ –º–µ–Ω—é
- `Enter` - –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
