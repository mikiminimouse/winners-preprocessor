# –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–º–µ—á–∞–Ω–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ docprep

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏ —É–ª—É—á—à–µ–Ω–∏–π, –≤–Ω–µ—Å–µ–Ω–Ω—ã—Ö –≤ —Å–∏—Å—Ç–µ–º—É docprep –≤ —Ä–∞–º–∫–∞—Ö —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞. –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ –æ—Ç—á–µ—Ç–æ–≤ –≤ `/root/.gemini/antigravity/brain/00f6ccf3-af82-40cb-9c9b-e315edc4ad28/` –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ `docprep/docs/`.

## üõ† –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ .doc —Ñ–∞–π–ª–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞**: .doc —Ñ–∞–π–ª—ã –æ—à–∏–±–æ—á–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ .xlsx –≤–º–µ—Å—Ç–æ .docx

**–ü—Ä–∏—á–∏–Ω–∞**: 
- `detect_file_type()` –æ–ø—Ä–µ–¥–µ–ª—è–ª doc —Ñ–∞–π–ª—ã –∫–∞–∫ `xls` (Excel)
- –í —Ñ—É–Ω–∫—Ü–∏–∏ `get_extension_subdirectory()` –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "convert" –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `detected_type` –≤–º–µ—Å—Ç–æ `original_extension`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
1. –í `classifier.py` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ `original_extension` –∏–∑ —Ñ–∞–π–ª–∞
2. –í `unit_processor.py` —É–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "convert" - —Ç–µ–ø–µ—Ä—å –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/engine/classifier.py`
- `docprep/core/unit_processor.py`
- `docprep/core/config.py` (CONVERSION_MAP –∏—Å–ø—Ä–∞–≤–ª–µ–Ω: doc ‚Üí docx –≤–º–µ—Å—Ç–æ doc ‚Üí xlsx)

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è PDF —Ñ–∞–π–ª–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞**: PDF UNIT –ø–æ–ø–∞–¥–∞–ª–∏ –≤ –∫–æ—Ä–µ–Ω—å `pdf/` –≤–º–µ—Å—Ç–æ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π `pdf/scan`, `pdf/text`, `pdf/mixed`

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ PDF

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è PDF –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º (–≤–∫–ª—é—á–∞—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ç–∏–ø–∞ "–≥PDF")
- –í—Å–µ PDF UNIT –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤ pdf/scan, pdf/text, pdf/mixed, pdf/unknown
- –£–±—Ä–∞–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ø–∞–¥–∞–Ω–∏—è PDF UNIT –≤ –∫–æ—Ä–µ–Ω—å pdf/ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/engine/merger.py`
- `docprep/core/routing.py`

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UNIT –∏–∑ Pending_1/direct –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ Merge_1/direct

**–ü—Ä–æ–±–ª–µ–º–∞**: UNIT –∏–∑ `Pending_1/direct` –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–ª–∏—Å—å –≤ `Merge_1/direct`

**–ü—Ä–∏—á–∏–Ω–∞**: –ü—É—Ç—å –∫ Merge —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ - –Ω–µ –¥–æ–±–∞–≤–ª—è–ª—Å—è `/direct`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```python
# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥:
cycle_paths = get_cycle_paths(cycle, None, merge_base, None)
target_dir = cycle_paths["merge"] / "direct"  # Merge_N/direct
```

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/cli/stage.py`

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞**: 144 UNIT –ø–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞—Ä—Ö–∏–≤–æ–≤ –±—ã–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ empty

**–ü—Ä–∏—á–∏–Ω–∞**: –§—É–Ω–∫—Ü–∏—è `get_unit_files()` –Ω–µ –Ω–∞—Ö–æ–¥–∏–ª–∞ —Ñ–∞–π–ª—ã –≤–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: `get_unit_files()` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `rglob("*")` –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/utils/paths.py`

## üêû –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ UNIT

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö UNIT (unknown)

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—É—Å—Ç—ã–µ UNIT –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–ª–∏—Å—å –∏–∑ Input –≤ `Exceptions/Exceptions_1/Ambiguous/`

**–ü—Ä–∏—á–∏–Ω–∞**: –í —Ñ—É–Ω–∫—Ü–∏–∏ `classify_unit` –¥–ª—è –ø—É—Å—Ç—ã—Ö UNIT —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–æ –Ω–µ –≤—ã–∑—ã–≤–∞–ª–∞ `move_unit_to_target`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –ø—É—Å—Ç—ã—Ö UNIT –≤ Ambiguous
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ manifest –¥–ª—è –ø—É—Å—Ç—ã—Ö UNIT
- –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ state machine –¥–ª—è –ø—É—Å—Ç—ã—Ö UNIT
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/engine/classifier.py`

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ ambiguous —Ñ–∞–π–ª–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞**: –§–∞–π–ª—ã, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Decision Engine –∫–∞–∫ "ambiguous", –Ω–µ –ø–æ–ø–∞–¥–∞–ª–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `Ambiguous/`

**–ü—Ä–∏—á–∏–Ω–∞**: 
- Scenario –∏–∑ Decision Engine –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è –≤ classification
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ ambiguous –∏—Å–∫–∞–ª–∞ scenario, –Ω–æ –æ–Ω –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `scenario` –≤ classification –¥–ª—è ambiguous —Ñ–∞–π–ª–æ–≤
- –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ ambiguous —Ñ–∞–π–ª–æ–≤ –≤ UNIT
- –ï—Å–ª–∏ –µ—Å—Ç—å ambiguous —Ñ–∞–π–ª—ã, UNIT –∏–¥–µ—Ç –≤ `Ambiguous/` –≤–º–µ—Å—Ç–æ `Special/`

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/engine/classifier.py`

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ mixed UNIT

**–ü—Ä–æ–±–ª–µ–º–∞**: Mixed units (–Ω–∞–ø—Ä–∏–º–µ—Ä, docx + pdf) –±—ã–ª–∏ incorrectly moved to `Direct/docx` instead of `Exceptions/Mixed`

**–ü—Ä–∏—á–∏–Ω–∞**: –§–ª–∞–≥ `is_mixed` –æ–ø—Ä–µ–¥–µ–ª—è–ª—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –æ–±—Ä–∞–±–æ—Ç–∫–∏, –∞ –Ω–µ –ø–æ —Ç–∏–ø–∞–º —Ñ–∞–π–ª–æ–≤

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `is_mixed` –≤ `classify_unit`
- –¢–µ–ø–µ—Ä—å `is_mixed` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ò –ø–æ —Ç–∏–ø–∞–º —Ñ–∞–π–ª–æ–≤
- UNIT —Å —Ñ–∞–π–ª–∞–º–∏ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ (–¥–∞–∂–µ –ø—Ä–∏ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏) —Å—á–∏—Ç–∞—é—Ç—Å—è mixed

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/engine/classifier.py`

## üìÅ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º

### 1. –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π

**–ü—Ä–æ–±–ª–µ–º—ã**:
- ZIP –∞—Ä—Ö–∏–≤—ã –ø–æ–ø–∞–¥–∞–ª–∏ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Extract/doc/` –≤–º–µ—Å—Ç–æ `Extract/zip/`)
- .doc —Ñ–∞–π–ª—ã –ø–æ–ø–∞–¥–∞–ª–∏ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Normalize/txt/` –∏–ª–∏ `Normalize/docx/` –≤–º–µ—Å—Ç–æ `Normalize/doc/`)

**–ü—Ä–∏—á–∏–Ω–∞**: –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π `extract` –∏ `normalize` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `detected_type` –≤–º–µ—Å—Ç–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ `get_extension_subdirectory` –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `extract` - —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ (zip, rar, 7z)
- –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ `get_extension_subdirectory` –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `normalize` - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ –æ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è `jpeg` ‚Üí `jpg`
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `original_extension` –≤ classification

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/core/unit_processor.py`
- `docprep/engine/classifier.py`

## üìù –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è audit logs

**–ü—Ä–æ–±–ª–µ–º–∞**: Audit log —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (`@final_preprocessing/audit_UNIT_*.log.jsonl`)

**–ü—Ä–∏—á–∏–Ω–∞**: 
- `AuditLogger.log_event` –∏–º–µ–ª fallback –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ª–æ–≥–æ–≤ –≤ —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –µ—Å–ª–∏ `unit_path` –Ω–µ –±—ã–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω
- –í `update_unit_state` `unit_path` –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –≤ `log_event`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω `AuditLogger.log_event` –¥–ª—è –≤—ã–∑–æ–≤–∞ –æ—à–∏–±–∫–∏, –µ—Å–ª–∏ `unit_path` –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω
- –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω `update_unit_state` –¥–ª—è —è–≤–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ `unit_path` –≤ `audit_logger.log_event`

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/core/audit.py`
- `docprep/core/unit_processor.py`

## üßπ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏ –ø—É—Å—Ç—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ—Å–ª–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è UNIT –æ—Å—Ç–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

**–ü—Ä–∏—á–∏–Ω–∞**: –§—É–Ω–∫—Ü–∏—è `move_unit_to_target()` —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ—â–∞–ª–∞ UNIT, –Ω–æ –Ω–µ –æ—á–∏—â–∞–ª–∞ –ø—É—Å—Ç—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_cleanup_empty_directories()` –≤ `unit_processor.py`
- –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ `move_unit_to_target()`

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/core/unit_processor.py`

## üÜï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –æ—à–∏–±–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `ErConvert`, `ErNormalaze`, `ErExtact` –≤ `Exceptions_N`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `ErMerge` –¥–ª—è –æ—à–∏–±–æ–∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ merge
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö
- –£–¥–∞–ª–µ–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `Unknown` –∏–∑ Exceptions (–∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ `Ambiguous`)

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `docprep/core/config.py`
- `docprep/engine/base_engine.py`
- `docprep/engine/converter.py`
- `docprep/engine/extractor.py`
- `docprep/engine/merger.py`
- `docprep/cli/merge.py`

## üìä –î–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### 1. –ú–æ–¥—É–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–°–æ–∑–¥–∞–Ω**: `docprep/utils/statistics.py`

**–§—É–Ω–∫—Ü–∏–∏**:
- `collect_input_statistics()` - —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `analyze_output_statistics()` - –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `calculate_percentage_statistics()` - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
- `generate_statistics_report()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞

### 2. CLI –∫–æ–º–∞–Ω–¥—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–°–æ–∑–¥–∞–Ω**: `docprep/cli/stats.py`

**–ö–æ–º–∞–Ω–¥—ã**:
- `docprep stats show <date>` - –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- `docprep stats show <date> --detailed` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `docprep stats show <date> --output <file>` - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª
- `docprep stats compare <date> --cycle1 N --cycle2 M` - —Å—Ä–∞–≤–Ω–∏—Ç—å —Ü–∏–∫–ª—ã
- `docprep stats export <date> --format <format> --output <file>` - —ç–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ –≥–ª–∞–≤–Ω–æ–º—É CLI –≤ `docprep/cli/main.py`

## üèó –£–ª—É—á—à–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤

- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –¥–ª—è .doc –ø–µ—Ä–µ–¥ OLE2 signature –ø—Ä–æ–≤–µ—Ä–∫–æ–π
- –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è PDF –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º –∏ –∏–º–µ–Ω–∞–º —Ñ–∞–π–ª–æ–≤
- Fallback –Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ detected_type = "unknown"

### 2. –£–ª—É—á—à–µ–Ω–∏—è Merger

- –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –≤–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤ (–Ω–µ –ø—É—Å—Ç—ã–µ, –ø—Ä–æ—à–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É)
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ mixed/special/ambiguous UNIT –∏–∑ Ready2Docling
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è PDF –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º

### 3. –£–ª—É—á—à–µ–Ω–∏—è Decision Engine

- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ scenario –∏–∑ Decision Engine
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ ambiguous —Ñ–∞–π–ª–æ–≤ –≤ UNIT
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤ `Ambiguous/` –∏–ª–∏ `Special/`

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:
1. `docs/ARCHITECTURE.md` - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–∏—Å—Ç–µ–º—ã
2. `docs/CLASSIFICATION_AND_STATISTICS.md` - –°–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
3. `docs/DEVELOPMENT_LOG.md` - –õ–æ–≥ –≤—Å–µ—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–æ–∫ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
4. `docs/BUGFIX_REPORT.md` - –û—Ç—á–µ—Ç –æ–± –∞–Ω–∞–ª–∏–∑–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º
5. `docs/CHANGELOG.md` - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
6. `docs/SUMMARY.md` - –°–≤–æ–¥–∫–∞ –ø–æ —Å–∏—Å—Ç–µ–º–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:
1. `docs/README.md` - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –∫–æ–º–∞–Ω–¥—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
2. `docs/TESTING_GUIDE.md` - –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (2025-12-20):
- **–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ UNIT**: 2585
- **–ü—É—Å—Ç—ã—Ö UNIT**: 780 (30%)
- **UNIT —Å —Ñ–∞–π–ª–∞–º–∏**: 1805 (69%)
- **–£—Å–ø–µ—à–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**: 100% (–¥–ª—è UNIT —Å —Ñ–∞–π–ª–∞–º–∏)
- **–û—à–∏–±–æ–∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**: 0

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (–±–µ–∑ –ø—É—Å—Ç—ã—Ö UNIT):
- **direct**: 1378 UNIT (76.3%)
- **extract**: 144 UNIT (7.9%)
- **convert**: 133 UNIT (7.3%)
- **mixed**: 128 UNIT (7.0%)
- **normalize**: 22 UNIT (1.2%)
- **unknown**: 0 UNIT (0.0%) - —Ç–æ–ª—å–∫–æ –ø—É—Å—Ç—ã–µ UNIT

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –û–±—â–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:
- **Accountability**: ~96.4%
- **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏**: ~4 –º–∏–Ω—É—Ç—ã –Ω–∞ 2585 UNIT
- **–ü–æ–¥–æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å**: 100% UNIT —É—á—Ç–µ–Ω—ã

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –º–∞—Ä—à—Ä—É—Ç–∞–º (Ready2Docling):
- **PDF**: 1031 (74.9%)
- **DOCX**: 340 (24.7%)
- **JPEG**: 3 (0.2%)
- **XLSX**: 1 (0.1%)
- **XML**: 1 (0.1%)

## üß™ –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –¢–µ—Å—Ç 1: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è doc —Ñ–∞–π–ª–æ–≤
```bash
python3 -m docprep.cli.main stage classifier \
  --cycle 1 \
  --input Data/Input/test_units \
  --date 2025-03-18 \
  --verbose
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: UNIT —Å doc —Ñ–∞–π–ª–∞–º–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ `Pending_1/convert/doc`

### –¢–µ—Å—Ç 2: –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤ Merge
```bash
python3 -m docprep.cli.main stage merge \
  --cycle 1 \
  --source Data/Processing/2025-03-18/Pending_1/direct \
  --date 2025-03-18 \
  --verbose
```
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: UNIT –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ `Merge_1/direct`

### –¢–µ—Å—Ç 3: –û—á–∏—Å—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
–ü–æ—Å–ª–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è UNIT –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ –ø—É—Å—Ç—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —É–¥–∞–ª–µ–Ω—ã.

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—É—Å—Ç—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —É–¥–∞–ª–µ–Ω—ã

### –¢–µ—Å—Ç 4: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏
```bash
python3 -m docprep.cli.main pipeline run \
  Data/Input/2025-03-18 \
  Data/Ready2Docling/2025-03-18 \
  --max-cycles 3 \
  --verbose
```

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è .doc —Ñ–∞–π–ª–æ–≤
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PDF —Ñ–∞–π–ª–æ–≤
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ UNIT –≤ Merge
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö UNIT
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ ambiguous —Ñ–∞–π–ª–æ–≤
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ mixed UNIT
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã audit logs
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- [x] –£–ª—É—á—à–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ 100% —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- [ ] –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ—Ç–µ—Ä—å –¥–∞–Ω–Ω—ã—Ö
- [ ] –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã docprep –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ. –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –º–µ—Ç—Ä–∏–∫, —Å–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º 2025-03-04.

–û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
1. **100% —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏** –¥–ª—è UNIT —Å —Ñ–∞–π–ª–∞–º–∏
2. **–ù—É–ª–µ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö** - –≤—Å–µ UNIT —É—á—Ç–µ–Ω—ã
3. **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –ø–æ –≤—Å–µ–º –∞—Å–ø–µ–∫—Ç–∞–º –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
5. **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã